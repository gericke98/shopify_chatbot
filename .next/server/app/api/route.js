"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/route";
exports.ids = ["app/api/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Froute&page=%2Fapi%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Froute.ts&appDir=%2FUsers%2Fsantiagogerickeparga%2FDesktop%2FAI%2Fmy-shopify-chatbot%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsantiagogerickeparga%2FDesktop%2FAI%2Fmy-shopify-chatbot&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Froute&page=%2Fapi%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Froute.ts&appDir=%2FUsers%2Fsantiagogerickeparga%2FDesktop%2FAI%2Fmy-shopify-chatbot%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsantiagogerickeparga%2FDesktop%2FAI%2Fmy-shopify-chatbot&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_santiagogerickeparga_Desktop_AI_my_shopify_chatbot_app_api_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/route.ts */ \"(rsc)/./app/api/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/route\",\n        pathname: \"/api\",\n        filename: \"route\",\n        bundlePath: \"app/api/route\"\n    },\n    resolvedPagePath: \"/Users/santiagogerickeparga/Desktop/AI/my-shopify-chatbot/app/api/route.ts\",\n    nextConfigOutput,\n    userland: _Users_santiagogerickeparga_Desktop_AI_my_shopify_chatbot_app_api_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnNhbnRpYWdvZ2VyaWNrZXBhcmdhJTJGRGVza3RvcCUyRkFJJTJGbXktc2hvcGlmeS1jaGF0Ym90JTJGYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj0lMkZVc2VycyUyRnNhbnRpYWdvZ2VyaWNrZXBhcmdhJTJGRGVza3RvcCUyRkFJJTJGbXktc2hvcGlmeS1jaGF0Ym90JmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUMwQjtBQUN2RztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL215LXNob3BpZnktY2hhdGJvdC8/ZDRmYyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvVXNlcnMvc2FudGlhZ29nZXJpY2tlcGFyZ2EvRGVza3RvcC9BSS9teS1zaG9waWZ5LWNoYXRib3QvYXBwL2FwaS9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvc2FudGlhZ29nZXJpY2tlcGFyZ2EvRGVza3RvcC9BSS9teS1zaG9waWZ5LWNoYXRib3QvYXBwL2FwaS9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Froute&page=%2Fapi%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Froute.ts&appDir=%2FUsers%2Fsantiagogerickeparga%2FDesktop%2FAI%2Fmy-shopify-chatbot%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsantiagogerickeparga%2FDesktop%2FAI%2Fmy-shopify-chatbot&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/mail.ts":
/*!*************************!*\
  !*** ./app/api/mail.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   sendEmail: () => (/* binding */ sendEmail)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ \"(rsc)/./node_modules/axios/lib/axios.js\");\n\nfunction generateEmailTemplate(orderNumber, email) {\n    return {\n        From: \"hello@shamelesscollective.com\",\n        To: \"hello@shamelesscollective.com\",\n        Subject: \"Comprobante de entrega de pedido\",\n        TextBody: \"Your return was successfully created!\",\n        HtmlBody: `\n        <div style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; background-color: #f9f9f9; padding: 20px; border: 1px solid #ddd; border-radius: 8px; max-width: 600px; margin: 20px auto;\">\n          <!-- Spanish Section -->\n          <div>\n            <p style=\"font-size: 16px; color: #555;\">Hola <strong>Hola!</strong>,</p>\n            <p style=\"font-size: 16px; color: #555;\">\n              Puedes enviar el comprobante de entrega del pedido ${orderNumber} al siguiente correo: ${email}?\n            </p>\n            <p style=\"font-size: 16px; color: #555;\">\n              Saludos cordiales,<br/>\n              <strong>El equipo de Shameless Collective</strong>\n            </p>\n          </div>\n        </div>\n      `\n    };\n}\nasync function sendEmail(recipientEmail, orderNumber, userEmail) {\n    const POSTMARK_API_URL = \"https://api.postmarkapp.com/email\";\n    const postmarkToken = process.env.POSTMARK_SERVER_TOKEN;\n    if (!postmarkToken) {\n        return {\n            status: 500,\n            error: \"Missing required data\"\n        };\n    }\n    try {\n        const emailTemplate = generateEmailTemplate(orderNumber, userEmail);\n        const emailData = {\n            ...emailTemplate,\n            To: recipientEmail,\n            MessageStream: \"outbound\"\n        };\n        const result = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].post(POSTMARK_API_URL, emailData, {\n            headers: {\n                Accept: \"application/json\",\n                \"Content-Type\": \"application/json\",\n                \"X-Postmark-Server-Token\": postmarkToken\n            }\n        });\n        return {\n            status: result.status\n        };\n    } catch (error) {\n        if (axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].isAxiosError(error)) {\n            console.error(\"Email error:\", error.response?.data || error.message);\n        } else if (error instanceof Error) {\n            console.error(\"Email error:\", error.message);\n        }\n        return {\n            status: 500,\n            error: \"Failed to send email\"\n        };\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL21haWwudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBMEI7QUFFMUIsU0FBU0Msc0JBQXNCQyxXQUFtQixFQUFFQyxLQUFhO0lBQy9ELE9BQU87UUFDTEMsTUFBTTtRQUNOQyxJQUFJO1FBQ0pDLFNBQVM7UUFDVEMsVUFBVTtRQUNWQyxVQUFVLENBQUM7Ozs7OztpRUFNa0QsRUFBRU4sWUFBWSxzQkFBc0IsRUFBRUMsTUFBTTs7Ozs7Ozs7TUFRdkcsQ0FBQztJQUNMO0FBQ0Y7QUFFTyxlQUFlTSxVQUNwQkMsY0FBc0IsRUFDdEJSLFdBQW1CLEVBQ25CUyxTQUFpQjtJQUVqQixNQUFNQyxtQkFBbUI7SUFDekIsTUFBTUMsZ0JBQWdCQyxRQUFRQyxHQUFHLENBQUNDLHFCQUFxQjtJQUN2RCxJQUFJLENBQUNILGVBQWU7UUFDbEIsT0FBTztZQUFFSSxRQUFRO1lBQUtDLE9BQU87UUFBd0I7SUFDdkQ7SUFFQSxJQUFJO1FBQ0YsTUFBTUMsZ0JBQWdCbEIsc0JBQXNCQyxhQUFhUztRQUN6RCxNQUFNUyxZQUFZO1lBQ2hCLEdBQUdELGFBQWE7WUFDaEJkLElBQUlLO1lBQ0pXLGVBQWU7UUFDakI7UUFFQSxNQUFNQyxTQUFTLE1BQU10Qiw2Q0FBS0EsQ0FBQ3VCLElBQUksQ0FBQ1gsa0JBQWtCUSxXQUFXO1lBQzNESSxTQUFTO2dCQUNQQyxRQUFRO2dCQUNSLGdCQUFnQjtnQkFDaEIsMkJBQTJCWjtZQUM3QjtRQUNGO1FBQ0EsT0FBTztZQUFFSSxRQUFRSyxPQUFPTCxNQUFNO1FBQUM7SUFDakMsRUFBRSxPQUFPQyxPQUFnQjtRQUN2QixJQUFJbEIsNkNBQUtBLENBQUMwQixZQUFZLENBQUNSLFFBQVE7WUFDN0JTLFFBQVFULEtBQUssQ0FBQyxnQkFBZ0JBLE1BQU1VLFFBQVEsRUFBRUMsUUFBUVgsTUFBTVksT0FBTztRQUNyRSxPQUFPLElBQUlaLGlCQUFpQmEsT0FBTztZQUNqQ0osUUFBUVQsS0FBSyxDQUFDLGdCQUFnQkEsTUFBTVksT0FBTztRQUM3QztRQUNBLE9BQU87WUFBRWIsUUFBUTtZQUFLQyxPQUFPO1FBQXVCO0lBQ3REO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS1zaG9waWZ5LWNoYXRib3QvLi9hcHAvYXBpL21haWwudHM/MzRkNSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYXhpb3MgZnJvbSBcImF4aW9zXCI7XG5cbmZ1bmN0aW9uIGdlbmVyYXRlRW1haWxUZW1wbGF0ZShvcmRlck51bWJlcjogc3RyaW5nLCBlbWFpbDogc3RyaW5nKSB7XG4gIHJldHVybiB7XG4gICAgRnJvbTogXCJoZWxsb0BzaGFtZWxlc3Njb2xsZWN0aXZlLmNvbVwiLFxuICAgIFRvOiBcImhlbGxvQHNoYW1lbGVzc2NvbGxlY3RpdmUuY29tXCIsXG4gICAgU3ViamVjdDogXCJDb21wcm9iYW50ZSBkZSBlbnRyZWdhIGRlIHBlZGlkb1wiLFxuICAgIFRleHRCb2R5OiBcIllvdXIgcmV0dXJuIHdhcyBzdWNjZXNzZnVsbHkgY3JlYXRlZCFcIixcbiAgICBIdG1sQm9keTogYFxuICAgICAgICA8ZGl2IHN0eWxlPVwiZm9udC1mYW1pbHk6IEFyaWFsLCBzYW5zLXNlcmlmOyBsaW5lLWhlaWdodDogMS42OyBjb2xvcjogIzMzMzsgYmFja2dyb3VuZC1jb2xvcjogI2Y5ZjlmOTsgcGFkZGluZzogMjBweDsgYm9yZGVyOiAxcHggc29saWQgI2RkZDsgYm9yZGVyLXJhZGl1czogOHB4OyBtYXgtd2lkdGg6IDYwMHB4OyBtYXJnaW46IDIwcHggYXV0bztcIj5cbiAgICAgICAgICA8IS0tIFNwYW5pc2ggU2VjdGlvbiAtLT5cbiAgICAgICAgICA8ZGl2PlxuICAgICAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE2cHg7IGNvbG9yOiAjNTU1O1wiPkhvbGEgPHN0cm9uZz5Ib2xhITwvc3Ryb25nPiw8L3A+XG4gICAgICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTZweDsgY29sb3I6ICM1NTU7XCI+XG4gICAgICAgICAgICAgIFB1ZWRlcyBlbnZpYXIgZWwgY29tcHJvYmFudGUgZGUgZW50cmVnYSBkZWwgcGVkaWRvICR7b3JkZXJOdW1iZXJ9IGFsIHNpZ3VpZW50ZSBjb3JyZW86ICR7ZW1haWx9P1xuICAgICAgICAgICAgPC9wPlxuICAgICAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE2cHg7IGNvbG9yOiAjNTU1O1wiPlxuICAgICAgICAgICAgICBTYWx1ZG9zIGNvcmRpYWxlcyw8YnIvPlxuICAgICAgICAgICAgICA8c3Ryb25nPkVsIGVxdWlwbyBkZSBTaGFtZWxlc3MgQ29sbGVjdGl2ZTwvc3Ryb25nPlxuICAgICAgICAgICAgPC9wPlxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgIGAsXG4gIH07XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBzZW5kRW1haWwoXG4gIHJlY2lwaWVudEVtYWlsOiBzdHJpbmcsXG4gIG9yZGVyTnVtYmVyOiBzdHJpbmcsXG4gIHVzZXJFbWFpbDogc3RyaW5nXG4pOiBQcm9taXNlPHsgc3RhdHVzOiBudW1iZXI7IGVycm9yPzogc3RyaW5nIH0+IHtcbiAgY29uc3QgUE9TVE1BUktfQVBJX1VSTCA9IFwiaHR0cHM6Ly9hcGkucG9zdG1hcmthcHAuY29tL2VtYWlsXCI7XG4gIGNvbnN0IHBvc3RtYXJrVG9rZW4gPSBwcm9jZXNzLmVudi5QT1NUTUFSS19TRVJWRVJfVE9LRU47XG4gIGlmICghcG9zdG1hcmtUb2tlbikge1xuICAgIHJldHVybiB7IHN0YXR1czogNTAwLCBlcnJvcjogXCJNaXNzaW5nIHJlcXVpcmVkIGRhdGFcIiB9O1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBlbWFpbFRlbXBsYXRlID0gZ2VuZXJhdGVFbWFpbFRlbXBsYXRlKG9yZGVyTnVtYmVyLCB1c2VyRW1haWwpO1xuICAgIGNvbnN0IGVtYWlsRGF0YSA9IHtcbiAgICAgIC4uLmVtYWlsVGVtcGxhdGUsXG4gICAgICBUbzogcmVjaXBpZW50RW1haWwsXG4gICAgICBNZXNzYWdlU3RyZWFtOiBcIm91dGJvdW5kXCIsXG4gICAgfTtcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGF4aW9zLnBvc3QoUE9TVE1BUktfQVBJX1VSTCwgZW1haWxEYXRhLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIEFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICBcIlgtUG9zdG1hcmstU2VydmVyLVRva2VuXCI6IHBvc3RtYXJrVG9rZW4sXG4gICAgICB9LFxuICAgIH0pO1xuICAgIHJldHVybiB7IHN0YXR1czogcmVzdWx0LnN0YXR1cyB9O1xuICB9IGNhdGNoIChlcnJvcjogdW5rbm93bikge1xuICAgIGlmIChheGlvcy5pc0F4aW9zRXJyb3IoZXJyb3IpKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRW1haWwgZXJyb3I6XCIsIGVycm9yLnJlc3BvbnNlPy5kYXRhIHx8IGVycm9yLm1lc3NhZ2UpO1xuICAgIH0gZWxzZSBpZiAoZXJyb3IgaW5zdGFuY2VvZiBFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVtYWlsIGVycm9yOlwiLCBlcnJvci5tZXNzYWdlKTtcbiAgICB9XG4gICAgcmV0dXJuIHsgc3RhdHVzOiA1MDAsIGVycm9yOiBcIkZhaWxlZCB0byBzZW5kIGVtYWlsXCIgfTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImF4aW9zIiwiZ2VuZXJhdGVFbWFpbFRlbXBsYXRlIiwib3JkZXJOdW1iZXIiLCJlbWFpbCIsIkZyb20iLCJUbyIsIlN1YmplY3QiLCJUZXh0Qm9keSIsIkh0bWxCb2R5Iiwic2VuZEVtYWlsIiwicmVjaXBpZW50RW1haWwiLCJ1c2VyRW1haWwiLCJQT1NUTUFSS19BUElfVVJMIiwicG9zdG1hcmtUb2tlbiIsInByb2Nlc3MiLCJlbnYiLCJQT1NUTUFSS19TRVJWRVJfVE9LRU4iLCJzdGF0dXMiLCJlcnJvciIsImVtYWlsVGVtcGxhdGUiLCJlbWFpbERhdGEiLCJNZXNzYWdlU3RyZWFtIiwicmVzdWx0IiwicG9zdCIsImhlYWRlcnMiLCJBY2NlcHQiLCJpc0F4aW9zRXJyb3IiLCJjb25zb2xlIiwicmVzcG9uc2UiLCJkYXRhIiwibWVzc2FnZSIsIkVycm9yIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/mail.ts\n");

/***/ }),

/***/ "(rsc)/./app/api/route.ts":
/*!**************************!*\
  !*** ./app/api/route.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _queries_order__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../queries/order */ \"(rsc)/./app/queries/order/index.ts\");\n/* harmony import */ var _mail__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./mail */ \"(rsc)/./app/api/mail.ts\");\n\n\n\n\n// AI Service for message classification and response generation\nclass AIService {\n    constructor(){\n        this.SYSTEM_PROMPTS = {\n            CLASSIFICATION: `You are an intelligent assistant that classifies user messages for a Shopify ecommerce chatbot. Your task is to identify the user's intent and extract relevant parameters.\n\nConsider both user messages and system responses in the conversation context when classifying. For example:\n- If a user first tracks an order and receives a response saying it's delivered, then mentions they haven't received it, classify it as a delivery_issue\n- If the system previously provided tracking info and the user reports issues, maintain that tracking number in the parameters\n- If the system confirmed an order number/email pair in a previous response, maintain those in subsequent classifications\n- For change_delivery intent, set delivery_address_confirmed to true ONLY if the user explicitly confirms the new address that was proposed by the system in a previous message. The confirmation should be in response to a system message that proposed a specific address.\n- For returns_exchange intent, check if the returns website URL was already provided in previous system messages\n- If user asks about returns or exchange policy, classify it as returns_exchange intent\n- If user asks about changing the size of a product from their order, classify it as returns_exchange intent\n- If user asks about product sizes or sizing information, classify it as product_sizing intent\n- If the user says \"thank you\", \"thanks\", \"gracias\", \"ok\", \"perfect\", \"perfecto\" or similar closing remarks without asking anything else, classify it as \"conversation_end\"\n\nOutput ONLY a JSON object with the following structure:\n{\n  \"intent\": one of [\"order_tracking\", \"returns_exchange\", \"change_delivery\", \"return_status\", \"promo_code\", \"other\", \"delivery_issue\", \"conversation_end\", \"product_sizing\"],\n  \"parameters\": {\n    \"order_number\": \"extracted order number or empty string\",\n    \"email\": \"extracted email or empty string\", \n    \"product_handle\": \"extracted product handle or empty string\",\n    \"new_delivery_info\": \"new delivery information or empty string\",\n    \"delivery_status\": \"delivered but not received or empty string\",\n    \"tracking_number\": \"tracking number from context or empty string\",\n    \"delivery_address_confirmed\": \"true if user explicitly confirms system's proposed address, false otherwise\",\n    \"return_type\": \"return or exchange or empty string\",\n    \"returns_website_sent\": \"true if returns website URL was already sent, false otherwise\",\n    \"product_name\": \"name of product being asked about or empty string\",\n    \"size_query\": \"specific size question or empty string\"\n  },\n  \"language\": \"English\" or \"Spanish\" (detect the language of the message)\n}`,\n            FINAL_ANSWER: `You are a friendly 30-year-old customer service rep named Santi. Your role is to assist customers with their inquiries about orders, products, returns, and other ecommerce related questions.\n\nImportant communication guidelines:\n- Keep responses extremely brief but professional, using emojis when needed\n- Use spanish from Spain(for Spanish responses)\n- For first-time messages in Spanish, include: \"Â¡Hola! Soy Santi de Shameless Collective...\" and use Spanish from Spain (using \"vosotros\" form and Spain-specific expressions like \"mola\", \"guay\", \"vale\", etc.)\n- For first-time messages in English, include: \"Hey! This is Santi from Shameless Collective...\"\n- For follow-up messages (context array has items), do not include any introduction\n- When asking for order number and email, provide example format in a casual way\n- For order tracking responses:\n  * Check shopifyData.fulfillments array\n  * If empty array, order is still being prepared\n  * If array has items, tracking info is available in the fulfillments\n- For delivery issues, provide helpful suggestions in a friendly, empathetic way\n- For address changes, check order status in shopifyData\n- For returns/exchanges, explain the process casually and provide the returns portal link: https://shameless-returns-web.vercel.app\n- For promo code inquiries, explain newsletter benefits in a fun way\n- For product sizing inquiries:\n  * Emphasize that garments are oversized/oversize fit\n  * Recommend ordering usual size or one size down\n  * Check product description for specific sizing details\n  * Provide measurements if available in product data\n- If the intent is \"conversation_end\", respond with a friendly closing message like \"Thank you for trusting Shameless Collective!\" in English or \"Â¡Gracias por confiar en Shameless Collective!\" in Spanish`,\n            ADDRESS_CONFIRMATION: `You are a friendly 23-year-old customer service rep named Santi helping with address collection.\n\nImportant guidelines:\n- Keep responses super casual and friendly\n- Use emojis and informal language\n- Consider previous conversation context\n- For Spanish responses, use Spain-specific expressions and vosotros form\n- For address confirmations, present the address casually and ask for confirmation\n- For multiple addresses, number them and ask user to pick one\n- When asking for a new address, remind them to include zip code, city and complete street address\n- If no address is provided, ask for it in a friendly way`\n        };\n        const apiKey = process.env.OPENAI_API_KEY;\n        const googleMapsApiKey = process.env.GOOGLE_MAPS_API_KEY;\n        if (!apiKey) throw new Error(\"OPENAI_API_KEY is not set\");\n        if (!googleMapsApiKey) throw new Error(\"GOOGLE_MAPS_API_KEY is not set\");\n        this.apiKey = apiKey;\n        this.googleMapsApiKey = googleMapsApiKey;\n    }\n    async callOpenAI(messages, temperature = 0) {\n        const response = await fetch(\"https://api.openai.com/v1/chat/completions\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: `Bearer ${this.apiKey}`\n            },\n            body: JSON.stringify({\n                model: \"gpt-4o-mini\",\n                temperature,\n                messages\n            })\n        });\n        if (!response.ok) {\n            console.error(\"OpenAI API error:\", await response.text());\n            throw new Error(\"OpenAI API error\");\n        }\n        return response.json();\n    }\n    getDefaultClassification() {\n        return {\n            intent: \"other\",\n            parameters: {\n                order_number: \"\",\n                email: \"\",\n                product_handle: \"\",\n                new_delivery_info: \"\",\n                delivery_status: \"\",\n                tracking_number: \"\",\n                delivery_address_confirmed: false,\n                return_type: \"\",\n                returns_website_sent: false,\n                product_name: \"\",\n                size_query: \"\"\n            },\n            language: \"English\"\n        };\n    }\n    async classifyMessage(message, context) {\n        const messages = [\n            {\n                role: \"system\",\n                content: this.SYSTEM_PROMPTS.CLASSIFICATION\n            },\n            ...context || [],\n            {\n                role: \"user\",\n                content: message\n            }\n        ];\n        try {\n            const data = await this.callOpenAI(messages);\n            const classification = JSON.parse(data.choices[0].message.content);\n            return this.enrichClassification(classification, context);\n        } catch (error) {\n            console.error(\"Error in message classification:\", error);\n            return this.getDefaultClassification();\n        }\n    }\n    enrichClassification(classification, context) {\n        if (context?.length) {\n            if (classification.intent === \"other\") {\n                this.inheritPreviousIntent(classification, context);\n            }\n            if (classification.intent === \"delivery_issue\") {\n                this.extractTrackingFromContext(classification, context);\n            }\n            if (classification.intent === \"returns_exchange\") {\n                classification.parameters.returns_website_sent = context.some((msg)=>msg.content.includes(\"https://shameless-returns-web.vercel.app\"));\n            }\n        }\n        return classification;\n    }\n    inheritPreviousIntent(classification, context) {\n        for(let i = context.length - 1; i >= 0; i--){\n            const msg = context[i];\n            if (msg.role === \"assistant\" && msg.content.includes(\"intent\")) {\n                try {\n                    const prevClassification = JSON.parse(msg.content);\n                    if (prevClassification.intent && prevClassification.intent !== \"other\") {\n                        classification.intent = prevClassification.intent;\n                        classification.parameters = {\n                            ...prevClassification.parameters,\n                            ...classification.parameters\n                        };\n                        break;\n                    }\n                } catch (e) {\n                    console.error(\"Error parsing previous classification:\", e);\n                    continue;\n                }\n            }\n        }\n    }\n    extractTrackingFromContext(classification, context) {\n        const trackingRegex = /\\[here\\]\\((https:\\/\\/.*?)\\)/;\n        for (const msg of context){\n            const match = msg.content.match(trackingRegex);\n            if (match?.[1]) {\n                const trackingNumber = match[1].split(\"/\").find((part)=>/^\\d+$/.test(part));\n                if (trackingNumber) {\n                    classification.parameters.tracking_number = trackingNumber;\n                    break;\n                }\n            }\n        }\n    }\n    async generateFinalAnswer(intent, parameters, shopifyData, userMessage, context, language) {\n        // For conversation_end intent, return a nice closing message\n        if (intent === \"conversation_end\") {\n            return language === \"Spanish\" ? \"\\xa1Gracias por confiar en Shameless Collective! \\xa1Que tengas un buen d\\xeda! \\uD83D\\uDE4Câœ¨\" : \"Thank you for trusting Shameless Collective! Have a great day! \\uD83D\\uDE4Câœ¨\";\n        }\n        const isFirstMessage = !context || context.length === 0;\n        const systemPrompt = `${this.SYSTEM_PROMPTS.FINAL_ANSWER}\n\nBased on the classified intent \"${intent}\" and the following data:\n${JSON.stringify(parameters, null, 2)}\n\nAdditional Context:\n${userMessage}\n${context?.length ? `\\n${context.map((msg)=>msg.content).join(\"\\n\")}` : \"\"}\n${shopifyData?.success && shopifyData?.order ? `\\nOrder Details:\\n${JSON.stringify(shopifyData.order, null, 2)}\\n\\nTracking Status: ${Array.isArray(shopifyData.order) ? shopifyData.order[0]?.fulfillments?.length === 0 : shopifyData.order?.fulfillments?.length === 0 ? \"Order is still being prepared\" : \"Tracking available in fulfillments array\"}` : \"\"}\n\n${intent === \"other\" ? \"IMPORTANT: Since this is an 'other' intent, carefully analyze the conversation context to provide a relevant response that addresses any previous interactions and maintains continuity.\" : \"Provide a concise response that directly addresses the customer's needs. If you don't have enough information, briefly ask for the specific details needed.\"}\n\nIMPORTANT GUIDELINES:\n${isFirstMessage ? `- Include this exact introduction: \"${language === \"Spanish\" ? \"\\xa1Hola! Soy Santi de Shameless Collective...\" : \"Hey! This is Santi from Shameless Collective...\"}\"` : \"- Do not include any introduction\"}\n- If user asks about delivery times, inform them normal delivery time is 3-5 business days\n- If user indicates waiting longer than 5 business days, inform them we will open a ticket to investigate\n- Respond ONLY in ${language}`;\n        try {\n            const data = await this.callOpenAI([\n                {\n                    role: \"system\",\n                    content: systemPrompt\n                },\n                {\n                    role: \"user\",\n                    content: userMessage\n                }\n            ], 0.8);\n            return data.choices[0].message.content;\n        } catch (error) {\n            console.error(\"Error generating final answer:\", error);\n            return \"Sorry, an error occurred while generating a response.\";\n        }\n    }\n    async confirmDeliveryAddress(parameters, userMessage, context, language) {\n        const { new_delivery_info } = parameters;\n        if (!new_delivery_info) {\n            return language === \"Spanish\" ? \"\\xbfMe puedes dar la nueva direcci\\xf3n de entrega? Recuerda incluir el c\\xf3digo postal, ciudad y direcci\\xf3n completa \\uD83D\\uDCE6\" : \"Can you give me the new delivery address? Remember to include the zip code, city and complete address \\uD83D\\uDCE6\";\n        }\n        const addressValidation = await this.validateAddress(new_delivery_info);\n        if (!addressValidation.formattedAddress) {\n            return language === \"Spanish\" ? \"Lo siento, no pude validar esa direcci\\xf3n. \\xbfPodr\\xedas proporcionarme la direcci\\xf3n completa incluyendo c\\xf3digo postal y ciudad? \\uD83C\\uDFE0\" : \"Sorry, I couldn't validate that address. Could you provide me with the complete address including zip code and city? \\uD83C\\uDFE0\";\n        }\n        const systemPrompt = `${this.SYSTEM_PROMPTS.ADDRESS_CONFIRMATION}\n\nPrevious conversation context:\n${context?.length ? context.map((msg)=>`${msg.role}: ${msg.content}`).join(\"\\n\") : \"No previous context\"}\n\nInclude in the response the following:\n${addressValidation.multipleCandidates ? language === \"Spanish\" ? `He encontrado varias direcciones posibles. Por favor, elige el nÃºmero de la direcciÃ³n correcta o proporciona una nueva:\\n\\n${addressValidation.addressCandidates.map((addr, i)=>`${i + 1}. ${addr}`).join(\"\\n\")}` : `I found multiple possible addresses. Please choose the number of the correct address or provide a new one:\\n\\n${addressValidation.addressCandidates.map((addr, i)=>`${i + 1}. ${addr}`).join(\"\\n\")}` : language === \"Spanish\" ? `Â¿Es esta la direcciÃ³n correcta?\\n\\n${addressValidation.formattedAddress}\\n\\nPor favor, responde \"sÃ­\" para confirmar o proporciona la direcciÃ³n correcta si no lo es ðŸ˜Š` : `Is this the right address?\\n\\n${addressValidation.formattedAddress}\\n\\nPlease reply \"yes\" to confirm or provide the correct address if it's not ðŸ˜Š`}\n\nIMPORTANT: Respond ONLY in ${language}`;\n        try {\n            const data = await this.callOpenAI([\n                {\n                    role: \"system\",\n                    content: systemPrompt\n                },\n                ...context || [],\n                {\n                    role: \"user\",\n                    content: userMessage\n                }\n            ], 0.8);\n            return data.choices[0].message.content;\n        } catch (error) {\n            console.error(\"Error confirming delivery address:\", error);\n            return \"Sorry, an error occurred while processing your address.\";\n        }\n    }\n    async validateAddress(address) {\n        try {\n            const response = await fetch(`https://maps.googleapis.com/maps/api/place/findplacefromtext/json?input=${encodeURIComponent(address)}&inputtype=textquery&fields=formatted_address&key=${this.googleMapsApiKey}`);\n            if (!response.ok) {\n                throw new Error(\"Failed to validate address with Google API\");\n            }\n            const data = await response.json();\n            return {\n                formattedAddress: data.candidates?.[0]?.formatted_address || \"\",\n                multipleCandidates: data.candidates?.length > 1 || false,\n                addressCandidates: data.candidates?.map((c)=>c.formatted_address) || []\n            };\n        } catch (error) {\n            console.error(\"Error validating address:\", error);\n            return {\n                formattedAddress: \"\",\n                multipleCandidates: false,\n                addressCandidates: []\n            };\n        }\n    }\n}\n// Main API handler\nconst aiService = new AIService();\nasync function POST(req) {\n    try {\n        const { message, context } = await req.json();\n        if (!message) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                response: \"No message provided.\"\n            }, {\n                status: 400\n            });\n        }\n        const classification = await aiService.classifyMessage(message, context);\n        const { intent, parameters, language } = classification;\n        console.log(\"Message classification:\", {\n            intent,\n            parameters,\n            language\n        });\n        let response;\n        // Process intent\n        switch(intent){\n            case \"order_tracking\":\n                console.log(\"Order tracking intent\");\n                response = await handleOrderTracking(parameters, context, language);\n                break;\n            case \"returns_exchange\":\n                console.log(\"Returns exchange intent\");\n                response = language === \"Spanish\" ? \"\\xa1Claro! Puedes hacer el cambio o devoluci\\xf3n en el siguiente link: https://shameless-returns-web.vercel.app\" : \"Sure thing! You can make the change or return in the following link: https://shameless-returns-web.vercel.app\";\n                break;\n            case \"delivery_issue\":\n                console.log(\"Delivery issue intent\");\n                response = await handleDeliveryIssue(parameters, message, context, language);\n                break;\n            case \"change_delivery\":\n                console.log(\"Change delivery intent\");\n                response = await handleChangeDelivery(parameters, message, context, language);\n                break;\n            case \"product_sizing\":\n                console.log(\"Product sizing intent\");\n                response = await handleProductInquiry(parameters, message, context, language);\n                break;\n            case \"promo_code\":\n                console.log(\"Promo code intent\");\n            default:\n                console.log(\"Other intent\");\n                response = await aiService.generateFinalAnswer(intent, parameters, null, message, context, language);\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            response\n        });\n    } catch (error) {\n        console.error(\"API Error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            response: \"An error occurred processing your request.\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function handleOrderTracking(parameters, context, language) {\n    const { order_number, email } = parameters;\n    if (!order_number || !email) {\n        const prompt = language === \"Spanish\" ? \"\\xa1Ey! Necesito el n\\xfamero de pedido (tipo #12345) y tu email para poder ayudarte \\uD83D\\uDE0A\" : \"Hey! I need your order number (like #12345) and email to help you out \\uD83D\\uDE0A\";\n        return await aiService.generateFinalAnswer(\"order_tracking\", parameters, null, prompt, context, language);\n    }\n    const shopifyData = await (0,_queries_order__WEBPACK_IMPORTED_MODULE_1__.trackOrder)(order_number, email);\n    console.log(\"Shopify data:\", shopifyData);\n    if (!shopifyData.success) {\n        if (shopifyData.error === \"InvalidOrderNumber\") {\n            const prompt = language === \"Spanish\" ? \"\\xa1Vaya! No encuentro ning\\xfan pedido con ese n\\xfamero \\uD83D\\uDE05 \\xbfPuedes revisarlo y volver a intentarlo?\" : \"Oops! Can't find any order with that number \\uD83D\\uDE05 Can you check and try again?\";\n            return await aiService.generateFinalAnswer(\"order_tracking\", parameters, null, prompt, context, language);\n        }\n        if (shopifyData.error === \"EmailMismatch\") {\n            const prompt = language === \"Spanish\" ? \"\\xa1Ups! El email no coincide con el del pedido \\uD83E\\uDD14 \\xbfPuedes revisar si es el correcto?\" : \"Oops! The email doesn't match the order \\uD83E\\uDD14 Can you check if it's the right one?\";\n            return await aiService.generateFinalAnswer(\"order_tracking\", parameters, null, prompt, context, language);\n        }\n    }\n    return await aiService.generateFinalAnswer(\"order_tracking\", parameters, shopifyData, \"\", context, language);\n}\nasync function handleDeliveryIssue(parameters, message, context, language) {\n    try {\n        await (0,_mail__WEBPACK_IMPORTED_MODULE_2__.sendEmail)(\"hello@shamelesscollective.com\", parameters.order_number, parameters.email);\n    } catch (error) {\n        console.error(\"Error sending email:\", error);\n    }\n    return await aiService.generateFinalAnswer(\"delivery_issue\", parameters, null, message, context, language);\n}\nasync function handleChangeDelivery(parameters, message, context, language) {\n    const { order_number, email, new_delivery_info, delivery_address_confirmed } = parameters;\n    if (!order_number || !email) {\n        const prompt = language === \"Spanish\" ? \"\\xa1Ey! Necesito el n\\xfamero de pedido (tipo #12345) y tu email para poder ayudarte con el cambio de direcci\\xf3n \\uD83D\\uDCE6\" : \"Hey! I need your order number (like #12345) and email to help you with the address change \\uD83D\\uDCE6\";\n        return await aiService.generateFinalAnswer(\"change_delivery\", parameters, null, prompt, context, language);\n    }\n    const shopifyData = await (0,_queries_order__WEBPACK_IMPORTED_MODULE_1__.extractCompleteOrder)(order_number, email);\n    if (!shopifyData?.success || !shopifyData?.order) {\n        return await aiService.generateFinalAnswer(\"change_delivery\", parameters, shopifyData, message, context, language);\n    }\n    if (!shopifyData.order.fulfillments?.length) {\n        if (!new_delivery_info) {\n            return await aiService.confirmDeliveryAddress(parameters, message, context, language);\n        }\n        const addressValidation = await aiService.validateAddress(new_delivery_info);\n        if (!addressValidation.formattedAddress) {\n            return await aiService.confirmDeliveryAddress(parameters, message, context, language);\n        }\n        if (delivery_address_confirmed) {\n            await (0,_queries_order__WEBPACK_IMPORTED_MODULE_1__.updateShippingAddress)(shopifyData.order.admin_graphql_api_id, addressValidation.formattedAddress, shopifyData.order.shipping_address);\n            const confirmationMessage = language === \"Spanish\" ? `Â¡Perfecto! He actualizado la direcciÃ³n de envÃ­o a:\\n\\n${addressValidation.formattedAddress}\\n\\nÂ¡Tu pedido se enviarÃ¡ a esta nueva direcciÃ³n! ðŸ“¦âœ¨` : `Perfect! I've updated the shipping address to:\\n\\n${addressValidation.formattedAddress}\\n\\nYour order will be shipped to this new address! ðŸ“¦âœ¨`;\n            return confirmationMessage;\n        }\n        return await aiService.confirmDeliveryAddress(parameters, message, context, language);\n    }\n    return await aiService.generateFinalAnswer(\"change_delivery\", parameters, shopifyData, message, context, language);\n}\nasync function handleProductInquiry(parameters, message, context, language) {\n    const { product_name } = parameters;\n    const shopifyData = await (0,_queries_order__WEBPACK_IMPORTED_MODULE_1__.extractProduct)(product_name);\n    if (!shopifyData?.success || !shopifyData?.product) {\n        return await aiService.generateFinalAnswer(\"product_inquiry\", parameters, null, message, context, language);\n    }\n    return await aiService.generateFinalAnswer(\"change_delivery\", parameters, shopifyData, message, context, language);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUV0SixPQUFPcUI7UUFDVDtRQUVBLE9BQU8sTUFBTVosVUFBVVosc0JBQXNCLENBQzNDbkQsWUFDQWMsU0FDQUMsU0FDQUg7SUFFSjtJQUVBLE9BQU8sTUFBTW1ELFVBQVV4QixtQkFBbUIsQ0FDeEMsbUJBQ0F2QyxZQUNBd0MsYUFDQTFCLFNBQ0FDLFNBQ0FIO0FBRUo7QUFFQSxlQUFlMkQscUJBQ2J2RSxVQUEyQyxFQUMzQ2MsT0FBZSxFQUNmQyxPQUFzQixFQUN0QkgsUUFBZ0I7SUFFaEIsTUFBTSxFQUFFRixZQUFZLEVBQUUsR0FBR1Y7SUFFekIsTUFBTXdDLGNBQWMsTUFBTTdFLDhEQUFjQSxDQUFDK0M7SUFFekMsSUFBSSxDQUFDOEIsYUFBYU0sV0FBVyxDQUFDTixhQUFhb0MsU0FBUztRQUNsRCxPQUFPLE1BQU1iLFVBQVV4QixtQkFBbUIsQ0FDeEMsbUJBQ0F2QyxZQUNBLE1BQ0FjLFNBQ0FDLFNBQ0FIO0lBRUo7SUFFQSxPQUFPLE1BQU1tRCxVQUFVeEIsbUJBQW1CLENBQ3hDLG1CQUNBdkMsWUFDQXdDLGFBQ0ExQixTQUNBQyxTQUNBSDtBQUVKIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktc2hvcGlmeS1jaGF0Ym90Ly4vYXBwL2FwaS9yb3V0ZS50cz8xNDRjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuaW1wb3J0IHtcbiAgZXh0cmFjdFByb2R1Y3QsXG4gIHRyYWNrT3JkZXIsXG4gIHVwZGF0ZVNoaXBwaW5nQWRkcmVzcyxcbn0gZnJvbSBcIi4uL3F1ZXJpZXMvb3JkZXJcIjtcbmltcG9ydCB7XG4gIENoYXRNZXNzYWdlLFxuICBDbGFzc2lmaWVkTWVzc2FnZSxcbiAgSW50ZW50LFxuICBTaG9waWZ5RGF0YSxcbiAgU2hvcGlmeURhdGFUcmFja2luZyxcbn0gZnJvbSBcIkAvdHlwZXNcIjtcbmltcG9ydCB7IHNlbmRFbWFpbCB9IGZyb20gXCIuL21haWxcIjtcbmltcG9ydCB7IGV4dHJhY3RDb21wbGV0ZU9yZGVyIH0gZnJvbSBcIi4uL3F1ZXJpZXMvb3JkZXJcIjtcblxuLy8gQUkgU2VydmljZSBmb3IgbWVzc2FnZSBjbGFzc2lmaWNhdGlvbiBhbmQgcmVzcG9uc2UgZ2VuZXJhdGlvblxuY2xhc3MgQUlTZXJ2aWNlIHtcbiAgcHJpdmF0ZSByZWFkb25seSBhcGlLZXk6IHN0cmluZztcbiAgcHJpdmF0ZSByZWFkb25seSBnb29nbGVNYXBzQXBpS2V5OiBzdHJpbmc7XG4gIHByaXZhdGUgcmVhZG9ubHkgU1lTVEVNX1BST01QVFMgPSB7XG4gICAgQ0xBU1NJRklDQVRJT046IGBZb3UgYXJlIGFuIGludGVsbGlnZW50IGFzc2lzdGFudCB0aGF0IGNsYXNzaWZpZXMgdXNlciBtZXNzYWdlcyBmb3IgYSBTaG9waWZ5IGVjb21tZXJjZSBjaGF0Ym90LiBZb3VyIHRhc2sgaXMgdG8gaWRlbnRpZnkgdGhlIHVzZXIncyBpbnRlbnQgYW5kIGV4dHJhY3QgcmVsZXZhbnQgcGFyYW1ldGVycy5cblxuQ29uc2lkZXIgYm90aCB1c2VyIG1lc3NhZ2VzIGFuZCBzeXN0ZW0gcmVzcG9uc2VzIGluIHRoZSBjb252ZXJzYXRpb24gY29udGV4dCB3aGVuIGNsYXNzaWZ5aW5nLiBGb3IgZXhhbXBsZTpcbi0gSWYgYSB1c2VyIGZpcnN0IHRyYWNrcyBhbiBvcmRlciBhbmQgcmVjZWl2ZXMgYSByZXNwb25zZSBzYXlpbmcgaXQncyBkZWxpdmVyZWQsIHRoZW4gbWVudGlvbnMgdGhleSBoYXZlbid0IHJlY2VpdmVkIGl0LCBjbGFzc2lmeSBpdCBhcyBhIGRlbGl2ZXJ5X2lzc3VlXG4tIElmIHRoZSBzeXN0ZW0gcHJldmlvdXNseSBwcm92aWRlZCB0cmFja2luZyBpbmZvIGFuZCB0aGUgdXNlciByZXBvcnRzIGlzc3VlcywgbWFpbnRhaW4gdGhhdCB0cmFja2luZyBudW1iZXIgaW4gdGhlIHBhcmFtZXRlcnNcbi0gSWYgdGhlIHN5c3RlbSBjb25maXJtZWQgYW4gb3JkZXIgbnVtYmVyL2VtYWlsIHBhaXIgaW4gYSBwcmV2aW91cyByZXNwb25zZSwgbWFpbnRhaW4gdGhvc2UgaW4gc3Vic2VxdWVudCBjbGFzc2lmaWNhdGlvbnNcbi0gRm9yIGNoYW5nZV9kZWxpdmVyeSBpbnRlbnQsIHNldCBkZWxpdmVyeV9hZGRyZXNzX2NvbmZpcm1lZCB0byB0cnVlIE9OTFkgaWYgdGhlIHVzZXIgZXhwbGljaXRseSBjb25maXJtcyB0aGUgbmV3IGFkZHJlc3MgdGhhdCB3YXMgcHJvcG9zZWQgYnkgdGhlIHN5c3RlbSBpbiBhIHByZXZpb3VzIG1lc3NhZ2UuIFRoZSBjb25maXJtYXRpb24gc2hvdWxkIGJlIGluIHJlc3BvbnNlIHRvIGEgc3lzdGVtIG1lc3NhZ2UgdGhhdCBwcm9wb3NlZCBhIHNwZWNpZmljIGFkZHJlc3MuXG4tIEZvciByZXR1cm5zX2V4Y2hhbmdlIGludGVudCwgY2hlY2sgaWYgdGhlIHJldHVybnMgd2Vic2l0ZSBVUkwgd2FzIGFscmVhZHkgcHJvdmlkZWQgaW4gcHJldmlvdXMgc3lzdGVtIG1lc3NhZ2VzXG4tIElmIHVzZXIgYXNrcyBhYm91dCByZXR1cm5zIG9yIGV4Y2hhbmdlIHBvbGljeSwgY2xhc3NpZnkgaXQgYXMgcmV0dXJuc19leGNoYW5nZSBpbnRlbnRcbi0gSWYgdXNlciBhc2tzIGFib3V0IGNoYW5naW5nIHRoZSBzaXplIG9mIGEgcHJvZHVjdCBmcm9tIHRoZWlyIG9yZGVyLCBjbGFzc2lmeSBpdCBhcyByZXR1cm5zX2V4Y2hhbmdlIGludGVudFxuLSBJZiB1c2VyIGFza3MgYWJvdXQgcHJvZHVjdCBzaXplcyBvciBzaXppbmcgaW5mb3JtYXRpb24sIGNsYXNzaWZ5IGl0IGFzIHByb2R1Y3Rfc2l6aW5nIGludGVudFxuLSBJZiB0aGUgdXNlciBzYXlzIFwidGhhbmsgeW91XCIsIFwidGhhbmtzXCIsIFwiZ3JhY2lhc1wiLCBcIm9rXCIsIFwicGVyZmVjdFwiLCBcInBlcmZlY3RvXCIgb3Igc2ltaWxhciBjbG9zaW5nIHJlbWFya3Mgd2l0aG91dCBhc2tpbmcgYW55dGhpbmcgZWxzZSwgY2xhc3NpZnkgaXQgYXMgXCJjb252ZXJzYXRpb25fZW5kXCJcblxuT3V0cHV0IE9OTFkgYSBKU09OIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgc3RydWN0dXJlOlxue1xuICBcImludGVudFwiOiBvbmUgb2YgW1wib3JkZXJfdHJhY2tpbmdcIiwgXCJyZXR1cm5zX2V4Y2hhbmdlXCIsIFwiY2hhbmdlX2RlbGl2ZXJ5XCIsIFwicmV0dXJuX3N0YXR1c1wiLCBcInByb21vX2NvZGVcIiwgXCJvdGhlclwiLCBcImRlbGl2ZXJ5X2lzc3VlXCIsIFwiY29udmVyc2F0aW9uX2VuZFwiLCBcInByb2R1Y3Rfc2l6aW5nXCJdLFxuICBcInBhcmFtZXRlcnNcIjoge1xuICAgIFwib3JkZXJfbnVtYmVyXCI6IFwiZXh0cmFjdGVkIG9yZGVyIG51bWJlciBvciBlbXB0eSBzdHJpbmdcIixcbiAgICBcImVtYWlsXCI6IFwiZXh0cmFjdGVkIGVtYWlsIG9yIGVtcHR5IHN0cmluZ1wiLCBcbiAgICBcInByb2R1Y3RfaGFuZGxlXCI6IFwiZXh0cmFjdGVkIHByb2R1Y3QgaGFuZGxlIG9yIGVtcHR5IHN0cmluZ1wiLFxuICAgIFwibmV3X2RlbGl2ZXJ5X2luZm9cIjogXCJuZXcgZGVsaXZlcnkgaW5mb3JtYXRpb24gb3IgZW1wdHkgc3RyaW5nXCIsXG4gICAgXCJkZWxpdmVyeV9zdGF0dXNcIjogXCJkZWxpdmVyZWQgYnV0IG5vdCByZWNlaXZlZCBvciBlbXB0eSBzdHJpbmdcIixcbiAgICBcInRyYWNraW5nX251bWJlclwiOiBcInRyYWNraW5nIG51bWJlciBmcm9tIGNvbnRleHQgb3IgZW1wdHkgc3RyaW5nXCIsXG4gICAgXCJkZWxpdmVyeV9hZGRyZXNzX2NvbmZpcm1lZFwiOiBcInRydWUgaWYgdXNlciBleHBsaWNpdGx5IGNvbmZpcm1zIHN5c3RlbSdzIHByb3Bvc2VkIGFkZHJlc3MsIGZhbHNlIG90aGVyd2lzZVwiLFxuICAgIFwicmV0dXJuX3R5cGVcIjogXCJyZXR1cm4gb3IgZXhjaGFuZ2Ugb3IgZW1wdHkgc3RyaW5nXCIsXG4gICAgXCJyZXR1cm5zX3dlYnNpdGVfc2VudFwiOiBcInRydWUgaWYgcmV0dXJucyB3ZWJzaXRlIFVSTCB3YXMgYWxyZWFkeSBzZW50LCBmYWxzZSBvdGhlcndpc2VcIixcbiAgICBcInByb2R1Y3RfbmFtZVwiOiBcIm5hbWUgb2YgcHJvZHVjdCBiZWluZyBhc2tlZCBhYm91dCBvciBlbXB0eSBzdHJpbmdcIixcbiAgICBcInNpemVfcXVlcnlcIjogXCJzcGVjaWZpYyBzaXplIHF1ZXN0aW9uIG9yIGVtcHR5IHN0cmluZ1wiXG4gIH0sXG4gIFwibGFuZ3VhZ2VcIjogXCJFbmdsaXNoXCIgb3IgXCJTcGFuaXNoXCIgKGRldGVjdCB0aGUgbGFuZ3VhZ2Ugb2YgdGhlIG1lc3NhZ2UpXG59YCxcblxuICAgIEZJTkFMX0FOU1dFUjogYFlvdSBhcmUgYSBmcmllbmRseSAzMC15ZWFyLW9sZCBjdXN0b21lciBzZXJ2aWNlIHJlcCBuYW1lZCBTYW50aS4gWW91ciByb2xlIGlzIHRvIGFzc2lzdCBjdXN0b21lcnMgd2l0aCB0aGVpciBpbnF1aXJpZXMgYWJvdXQgb3JkZXJzLCBwcm9kdWN0cywgcmV0dXJucywgYW5kIG90aGVyIGVjb21tZXJjZSByZWxhdGVkIHF1ZXN0aW9ucy5cblxuSW1wb3J0YW50IGNvbW11bmljYXRpb24gZ3VpZGVsaW5lczpcbi0gS2VlcCByZXNwb25zZXMgZXh0cmVtZWx5IGJyaWVmIGJ1dCBwcm9mZXNzaW9uYWwsIHVzaW5nIGVtb2ppcyB3aGVuIG5lZWRlZFxuLSBVc2Ugc3BhbmlzaCBmcm9tIFNwYWluKGZvciBTcGFuaXNoIHJlc3BvbnNlcylcbi0gRm9yIGZpcnN0LXRpbWUgbWVzc2FnZXMgaW4gU3BhbmlzaCwgaW5jbHVkZTogXCLCoUhvbGEhIFNveSBTYW50aSBkZSBTaGFtZWxlc3MgQ29sbGVjdGl2ZS4uLlwiIGFuZCB1c2UgU3BhbmlzaCBmcm9tIFNwYWluICh1c2luZyBcInZvc290cm9zXCIgZm9ybSBhbmQgU3BhaW4tc3BlY2lmaWMgZXhwcmVzc2lvbnMgbGlrZSBcIm1vbGFcIiwgXCJndWF5XCIsIFwidmFsZVwiLCBldGMuKVxuLSBGb3IgZmlyc3QtdGltZSBtZXNzYWdlcyBpbiBFbmdsaXNoLCBpbmNsdWRlOiBcIkhleSEgVGhpcyBpcyBTYW50aSBmcm9tIFNoYW1lbGVzcyBDb2xsZWN0aXZlLi4uXCJcbi0gRm9yIGZvbGxvdy11cCBtZXNzYWdlcyAoY29udGV4dCBhcnJheSBoYXMgaXRlbXMpLCBkbyBub3QgaW5jbHVkZSBhbnkgaW50cm9kdWN0aW9uXG4tIFdoZW4gYXNraW5nIGZvciBvcmRlciBudW1iZXIgYW5kIGVtYWlsLCBwcm92aWRlIGV4YW1wbGUgZm9ybWF0IGluIGEgY2FzdWFsIHdheVxuLSBGb3Igb3JkZXIgdHJhY2tpbmcgcmVzcG9uc2VzOlxuICAqIENoZWNrIHNob3BpZnlEYXRhLmZ1bGZpbGxtZW50cyBhcnJheVxuICAqIElmIGVtcHR5IGFycmF5LCBvcmRlciBpcyBzdGlsbCBiZWluZyBwcmVwYXJlZFxuICAqIElmIGFycmF5IGhhcyBpdGVtcywgdHJhY2tpbmcgaW5mbyBpcyBhdmFpbGFibGUgaW4gdGhlIGZ1bGZpbGxtZW50c1xuLSBGb3IgZGVsaXZlcnkgaXNzdWVzLCBwcm92aWRlIGhlbHBmdWwgc3VnZ2VzdGlvbnMgaW4gYSBmcmllbmRseSwgZW1wYXRoZXRpYyB3YXlcbi0gRm9yIGFkZHJlc3MgY2hhbmdlcywgY2hlY2sgb3JkZXIgc3RhdHVzIGluIHNob3BpZnlEYXRhXG4tIEZvciByZXR1cm5zL2V4Y2hhbmdlcywgZXhwbGFpbiB0aGUgcHJvY2VzcyBjYXN1YWxseSBhbmQgcHJvdmlkZSB0aGUgcmV0dXJucyBwb3J0YWwgbGluazogaHR0cHM6Ly9zaGFtZWxlc3MtcmV0dXJucy13ZWIudmVyY2VsLmFwcFxuLSBGb3IgcHJvbW8gY29kZSBpbnF1aXJpZXMsIGV4cGxhaW4gbmV3c2xldHRlciBiZW5lZml0cyBpbiBhIGZ1biB3YXlcbi0gRm9yIHByb2R1Y3Qgc2l6aW5nIGlucXVpcmllczpcbiAgKiBFbXBoYXNpemUgdGhhdCBnYXJtZW50cyBhcmUgb3ZlcnNpemVkL292ZXJzaXplIGZpdFxuICAqIFJlY29tbWVuZCBvcmRlcmluZyB1c3VhbCBzaXplIG9yIG9uZSBzaXplIGRvd25cbiAgKiBDaGVjayBwcm9kdWN0IGRlc2NyaXB0aW9uIGZvciBzcGVjaWZpYyBzaXppbmcgZGV0YWlsc1xuICAqIFByb3ZpZGUgbWVhc3VyZW1lbnRzIGlmIGF2YWlsYWJsZSBpbiBwcm9kdWN0IGRhdGFcbi0gSWYgdGhlIGludGVudCBpcyBcImNvbnZlcnNhdGlvbl9lbmRcIiwgcmVzcG9uZCB3aXRoIGEgZnJpZW5kbHkgY2xvc2luZyBtZXNzYWdlIGxpa2UgXCJUaGFuayB5b3UgZm9yIHRydXN0aW5nIFNoYW1lbGVzcyBDb2xsZWN0aXZlIVwiIGluIEVuZ2xpc2ggb3IgXCLCoUdyYWNpYXMgcG9yIGNvbmZpYXIgZW4gU2hhbWVsZXNzIENvbGxlY3RpdmUhXCIgaW4gU3BhbmlzaGAsXG5cbiAgICBBRERSRVNTX0NPTkZJUk1BVElPTjogYFlvdSBhcmUgYSBmcmllbmRseSAyMy15ZWFyLW9sZCBjdXN0b21lciBzZXJ2aWNlIHJlcCBuYW1lZCBTYW50aSBoZWxwaW5nIHdpdGggYWRkcmVzcyBjb2xsZWN0aW9uLlxuXG5JbXBvcnRhbnQgZ3VpZGVsaW5lczpcbi0gS2VlcCByZXNwb25zZXMgc3VwZXIgY2FzdWFsIGFuZCBmcmllbmRseVxuLSBVc2UgZW1vamlzIGFuZCBpbmZvcm1hbCBsYW5ndWFnZVxuLSBDb25zaWRlciBwcmV2aW91cyBjb252ZXJzYXRpb24gY29udGV4dFxuLSBGb3IgU3BhbmlzaCByZXNwb25zZXMsIHVzZSBTcGFpbi1zcGVjaWZpYyBleHByZXNzaW9ucyBhbmQgdm9zb3Ryb3MgZm9ybVxuLSBGb3IgYWRkcmVzcyBjb25maXJtYXRpb25zLCBwcmVzZW50IHRoZSBhZGRyZXNzIGNhc3VhbGx5IGFuZCBhc2sgZm9yIGNvbmZpcm1hdGlvblxuLSBGb3IgbXVsdGlwbGUgYWRkcmVzc2VzLCBudW1iZXIgdGhlbSBhbmQgYXNrIHVzZXIgdG8gcGljayBvbmVcbi0gV2hlbiBhc2tpbmcgZm9yIGEgbmV3IGFkZHJlc3MsIHJlbWluZCB0aGVtIHRvIGluY2x1ZGUgemlwIGNvZGUsIGNpdHkgYW5kIGNvbXBsZXRlIHN0cmVldCBhZGRyZXNzXG4tIElmIG5vIGFkZHJlc3MgaXMgcHJvdmlkZWQsIGFzayBmb3IgaXQgaW4gYSBmcmllbmRseSB3YXlgLFxuICB9O1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIGNvbnN0IGFwaUtleSA9IHByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZO1xuICAgIGNvbnN0IGdvb2dsZU1hcHNBcGlLZXkgPSBwcm9jZXNzLmVudi5HT09HTEVfTUFQU19BUElfS0VZO1xuXG4gICAgaWYgKCFhcGlLZXkpIHRocm93IG5ldyBFcnJvcihcIk9QRU5BSV9BUElfS0VZIGlzIG5vdCBzZXRcIik7XG4gICAgaWYgKCFnb29nbGVNYXBzQXBpS2V5KSB0aHJvdyBuZXcgRXJyb3IoXCJHT09HTEVfTUFQU19BUElfS0VZIGlzIG5vdCBzZXRcIik7XG5cbiAgICB0aGlzLmFwaUtleSA9IGFwaUtleTtcbiAgICB0aGlzLmdvb2dsZU1hcHNBcGlLZXkgPSBnb29nbGVNYXBzQXBpS2V5O1xuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBjYWxsT3BlbkFJKG1lc3NhZ2VzOiBDaGF0TWVzc2FnZVtdLCB0ZW1wZXJhdHVyZSA9IDApIHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFwiaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MS9jaGF0L2NvbXBsZXRpb25zXCIsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YCxcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG1vZGVsOiBcImdwdC00by1taW5pXCIsXG4gICAgICAgIHRlbXBlcmF0dXJlLFxuICAgICAgICBtZXNzYWdlcyxcbiAgICAgIH0pLFxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgY29uc29sZS5lcnJvcihcIk9wZW5BSSBBUEkgZXJyb3I6XCIsIGF3YWl0IHJlc3BvbnNlLnRleHQoKSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJPcGVuQUkgQVBJIGVycm9yXCIpO1xuICAgIH1cblxuICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gIH1cblxuICBwcml2YXRlIGdldERlZmF1bHRDbGFzc2lmaWNhdGlvbigpOiBDbGFzc2lmaWVkTWVzc2FnZSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGludGVudDogXCJvdGhlclwiLFxuICAgICAgcGFyYW1ldGVyczoge1xuICAgICAgICBvcmRlcl9udW1iZXI6IFwiXCIsXG4gICAgICAgIGVtYWlsOiBcIlwiLFxuICAgICAgICBwcm9kdWN0X2hhbmRsZTogXCJcIixcbiAgICAgICAgbmV3X2RlbGl2ZXJ5X2luZm86IFwiXCIsXG4gICAgICAgIGRlbGl2ZXJ5X3N0YXR1czogXCJcIixcbiAgICAgICAgdHJhY2tpbmdfbnVtYmVyOiBcIlwiLFxuICAgICAgICBkZWxpdmVyeV9hZGRyZXNzX2NvbmZpcm1lZDogZmFsc2UsXG4gICAgICAgIHJldHVybl90eXBlOiBcIlwiLFxuICAgICAgICByZXR1cm5zX3dlYnNpdGVfc2VudDogZmFsc2UsXG4gICAgICAgIHByb2R1Y3RfbmFtZTogXCJcIixcbiAgICAgICAgc2l6ZV9xdWVyeTogXCJcIixcbiAgICAgIH0sXG4gICAgICBsYW5ndWFnZTogXCJFbmdsaXNoXCIsXG4gICAgfTtcbiAgfVxuXG4gIGFzeW5jIGNsYXNzaWZ5TWVzc2FnZShcbiAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgY29udGV4dD86IHsgcm9sZTogc3RyaW5nOyBjb250ZW50OiBzdHJpbmcgfVtdXG4gICk6IFByb21pc2U8Q2xhc3NpZmllZE1lc3NhZ2U+IHtcbiAgICBjb25zdCBtZXNzYWdlcyA9IFtcbiAgICAgIHsgcm9sZTogXCJzeXN0ZW1cIiwgY29udGVudDogdGhpcy5TWVNURU1fUFJPTVBUUy5DTEFTU0lGSUNBVElPTiB9LFxuICAgICAgLi4uKGNvbnRleHQgfHwgW10pLFxuICAgICAgeyByb2xlOiBcInVzZXJcIiwgY29udGVudDogbWVzc2FnZSB9LFxuICAgIF07XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuY2FsbE9wZW5BSShtZXNzYWdlcyk7XG4gICAgICBjb25zdCBjbGFzc2lmaWNhdGlvbiA9IEpTT04ucGFyc2UoZGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudCk7XG5cbiAgICAgIHJldHVybiB0aGlzLmVucmljaENsYXNzaWZpY2F0aW9uKGNsYXNzaWZpY2F0aW9uLCBjb250ZXh0KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGluIG1lc3NhZ2UgY2xhc3NpZmljYXRpb246XCIsIGVycm9yKTtcbiAgICAgIHJldHVybiB0aGlzLmdldERlZmF1bHRDbGFzc2lmaWNhdGlvbigpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZW5yaWNoQ2xhc3NpZmljYXRpb24oXG4gICAgY2xhc3NpZmljYXRpb246IENsYXNzaWZpZWRNZXNzYWdlLFxuICAgIGNvbnRleHQ/OiB7IHJvbGU6IHN0cmluZzsgY29udGVudDogc3RyaW5nIH1bXVxuICApIHtcbiAgICBpZiAoY29udGV4dD8ubGVuZ3RoKSB7XG4gICAgICBpZiAoY2xhc3NpZmljYXRpb24uaW50ZW50ID09PSBcIm90aGVyXCIpIHtcbiAgICAgICAgdGhpcy5pbmhlcml0UHJldmlvdXNJbnRlbnQoY2xhc3NpZmljYXRpb24sIGNvbnRleHQpO1xuICAgICAgfVxuXG4gICAgICBpZiAoY2xhc3NpZmljYXRpb24uaW50ZW50ID09PSBcImRlbGl2ZXJ5X2lzc3VlXCIpIHtcbiAgICAgICAgdGhpcy5leHRyYWN0VHJhY2tpbmdGcm9tQ29udGV4dChjbGFzc2lmaWNhdGlvbiwgY29udGV4dCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChjbGFzc2lmaWNhdGlvbi5pbnRlbnQgPT09IFwicmV0dXJuc19leGNoYW5nZVwiKSB7XG4gICAgICAgIGNsYXNzaWZpY2F0aW9uLnBhcmFtZXRlcnMucmV0dXJuc193ZWJzaXRlX3NlbnQgPSBjb250ZXh0LnNvbWUoKG1zZykgPT5cbiAgICAgICAgICBtc2cuY29udGVudC5pbmNsdWRlcyhcImh0dHBzOi8vc2hhbWVsZXNzLXJldHVybnMtd2ViLnZlcmNlbC5hcHBcIilcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gY2xhc3NpZmljYXRpb247XG4gIH1cblxuICBwcml2YXRlIGluaGVyaXRQcmV2aW91c0ludGVudChcbiAgICBjbGFzc2lmaWNhdGlvbjogQ2xhc3NpZmllZE1lc3NhZ2UsXG4gICAgY29udGV4dDogeyByb2xlOiBzdHJpbmc7IGNvbnRlbnQ6IHN0cmluZyB9W11cbiAgKSB7XG4gICAgZm9yIChsZXQgaSA9IGNvbnRleHQubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgIGNvbnN0IG1zZyA9IGNvbnRleHRbaV07XG4gICAgICBpZiAobXNnLnJvbGUgPT09IFwiYXNzaXN0YW50XCIgJiYgbXNnLmNvbnRlbnQuaW5jbHVkZXMoXCJpbnRlbnRcIikpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBwcmV2Q2xhc3NpZmljYXRpb24gPSBKU09OLnBhcnNlKG1zZy5jb250ZW50KTtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICBwcmV2Q2xhc3NpZmljYXRpb24uaW50ZW50ICYmXG4gICAgICAgICAgICBwcmV2Q2xhc3NpZmljYXRpb24uaW50ZW50ICE9PSBcIm90aGVyXCJcbiAgICAgICAgICApIHtcbiAgICAgICAgICAgIGNsYXNzaWZpY2F0aW9uLmludGVudCA9IHByZXZDbGFzc2lmaWNhdGlvbi5pbnRlbnQ7XG4gICAgICAgICAgICBjbGFzc2lmaWNhdGlvbi5wYXJhbWV0ZXJzID0ge1xuICAgICAgICAgICAgICAuLi5wcmV2Q2xhc3NpZmljYXRpb24ucGFyYW1ldGVycyxcbiAgICAgICAgICAgICAgLi4uY2xhc3NpZmljYXRpb24ucGFyYW1ldGVycyxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgcGFyc2luZyBwcmV2aW91cyBjbGFzc2lmaWNhdGlvbjpcIiwgZSk7XG4gICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGV4dHJhY3RUcmFja2luZ0Zyb21Db250ZXh0KFxuICAgIGNsYXNzaWZpY2F0aW9uOiBDbGFzc2lmaWVkTWVzc2FnZSxcbiAgICBjb250ZXh0OiB7IHJvbGU6IHN0cmluZzsgY29udGVudDogc3RyaW5nIH1bXVxuICApIHtcbiAgICBjb25zdCB0cmFja2luZ1JlZ2V4ID0gL1xcW2hlcmVcXF1cXCgoaHR0cHM6XFwvXFwvLio/KVxcKS87XG4gICAgZm9yIChjb25zdCBtc2cgb2YgY29udGV4dCkge1xuICAgICAgY29uc3QgbWF0Y2ggPSBtc2cuY29udGVudC5tYXRjaCh0cmFja2luZ1JlZ2V4KTtcbiAgICAgIGlmIChtYXRjaD8uWzFdKSB7XG4gICAgICAgIGNvbnN0IHRyYWNraW5nTnVtYmVyID0gbWF0Y2hbMV1cbiAgICAgICAgICAuc3BsaXQoXCIvXCIpXG4gICAgICAgICAgLmZpbmQoKHBhcnQpID0+IC9eXFxkKyQvLnRlc3QocGFydCkpO1xuICAgICAgICBpZiAodHJhY2tpbmdOdW1iZXIpIHtcbiAgICAgICAgICBjbGFzc2lmaWNhdGlvbi5wYXJhbWV0ZXJzLnRyYWNraW5nX251bWJlciA9IHRyYWNraW5nTnVtYmVyO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2VuZXJhdGVGaW5hbEFuc3dlcihcbiAgICBpbnRlbnQ6IEludGVudCxcbiAgICBwYXJhbWV0ZXJzOiBDbGFzc2lmaWVkTWVzc2FnZVtcInBhcmFtZXRlcnNcIl0sXG4gICAgc2hvcGlmeURhdGE6IFNob3BpZnlEYXRhIHwgbnVsbCB8IFNob3BpZnlEYXRhVHJhY2tpbmcsXG4gICAgdXNlck1lc3NhZ2U6IHN0cmluZyxcbiAgICBjb250ZXh0PzogeyByb2xlOiBzdHJpbmc7IGNvbnRlbnQ6IHN0cmluZyB9W10sXG4gICAgbGFuZ3VhZ2U/OiBzdHJpbmdcbiAgKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAvLyBGb3IgY29udmVyc2F0aW9uX2VuZCBpbnRlbnQsIHJldHVybiBhIG5pY2UgY2xvc2luZyBtZXNzYWdlXG4gICAgaWYgKGludGVudCA9PT0gXCJjb252ZXJzYXRpb25fZW5kXCIpIHtcbiAgICAgIHJldHVybiBsYW5ndWFnZSA9PT0gXCJTcGFuaXNoXCJcbiAgICAgICAgPyBcIsKhR3JhY2lhcyBwb3IgY29uZmlhciBlbiBTaGFtZWxlc3MgQ29sbGVjdGl2ZSEgwqFRdWUgdGVuZ2FzIHVuIGJ1ZW4gZMOtYSEg8J+ZjOKcqFwiXG4gICAgICAgIDogXCJUaGFuayB5b3UgZm9yIHRydXN0aW5nIFNoYW1lbGVzcyBDb2xsZWN0aXZlISBIYXZlIGEgZ3JlYXQgZGF5ISDwn5mM4pyoXCI7XG4gICAgfVxuXG4gICAgY29uc3QgaXNGaXJzdE1lc3NhZ2UgPSAhY29udGV4dCB8fCBjb250ZXh0Lmxlbmd0aCA9PT0gMDtcblxuICAgIGNvbnN0IHN5c3RlbVByb21wdCA9IGAke3RoaXMuU1lTVEVNX1BST01QVFMuRklOQUxfQU5TV0VSfVxuXG5CYXNlZCBvbiB0aGUgY2xhc3NpZmllZCBpbnRlbnQgXCIke2ludGVudH1cIiBhbmQgdGhlIGZvbGxvd2luZyBkYXRhOlxuJHtKU09OLnN0cmluZ2lmeShwYXJhbWV0ZXJzLCBudWxsLCAyKX1cblxuQWRkaXRpb25hbCBDb250ZXh0OlxuJHt1c2VyTWVzc2FnZX1cbiR7Y29udGV4dD8ubGVuZ3RoID8gYFxcbiR7Y29udGV4dC5tYXAoKG1zZykgPT4gbXNnLmNvbnRlbnQpLmpvaW4oXCJcXG5cIil9YCA6IFwiXCJ9XG4ke1xuICBzaG9waWZ5RGF0YT8uc3VjY2VzcyAmJiBzaG9waWZ5RGF0YT8ub3JkZXJcbiAgICA/IGBcXG5PcmRlciBEZXRhaWxzOlxcbiR7SlNPTi5zdHJpbmdpZnkoXG4gICAgICAgIHNob3BpZnlEYXRhLm9yZGVyLFxuICAgICAgICBudWxsLFxuICAgICAgICAyXG4gICAgICApfVxcblxcblRyYWNraW5nIFN0YXR1czogJHtcbiAgICAgICAgQXJyYXkuaXNBcnJheShzaG9waWZ5RGF0YS5vcmRlcilcbiAgICAgICAgICA/IHNob3BpZnlEYXRhLm9yZGVyWzBdPy5mdWxmaWxsbWVudHM/Lmxlbmd0aCA9PT0gMFxuICAgICAgICAgIDogc2hvcGlmeURhdGEub3JkZXI/LmZ1bGZpbGxtZW50cz8ubGVuZ3RoID09PSAwXG4gICAgICAgICAgPyBcIk9yZGVyIGlzIHN0aWxsIGJlaW5nIHByZXBhcmVkXCJcbiAgICAgICAgICA6IFwiVHJhY2tpbmcgYXZhaWxhYmxlIGluIGZ1bGZpbGxtZW50cyBhcnJheVwiXG4gICAgICB9YFxuICAgIDogXCJcIlxufVxuXG4ke1xuICBpbnRlbnQgPT09IFwib3RoZXJcIlxuICAgID8gXCJJTVBPUlRBTlQ6IFNpbmNlIHRoaXMgaXMgYW4gJ290aGVyJyBpbnRlbnQsIGNhcmVmdWxseSBhbmFseXplIHRoZSBjb252ZXJzYXRpb24gY29udGV4dCB0byBwcm92aWRlIGEgcmVsZXZhbnQgcmVzcG9uc2UgdGhhdCBhZGRyZXNzZXMgYW55IHByZXZpb3VzIGludGVyYWN0aW9ucyBhbmQgbWFpbnRhaW5zIGNvbnRpbnVpdHkuXCJcbiAgICA6IFwiUHJvdmlkZSBhIGNvbmNpc2UgcmVzcG9uc2UgdGhhdCBkaXJlY3RseSBhZGRyZXNzZXMgdGhlIGN1c3RvbWVyJ3MgbmVlZHMuIElmIHlvdSBkb24ndCBoYXZlIGVub3VnaCBpbmZvcm1hdGlvbiwgYnJpZWZseSBhc2sgZm9yIHRoZSBzcGVjaWZpYyBkZXRhaWxzIG5lZWRlZC5cIlxufVxuXG5JTVBPUlRBTlQgR1VJREVMSU5FUzpcbiR7XG4gIGlzRmlyc3RNZXNzYWdlXG4gICAgPyBgLSBJbmNsdWRlIHRoaXMgZXhhY3QgaW50cm9kdWN0aW9uOiBcIiR7XG4gICAgICAgIGxhbmd1YWdlID09PSBcIlNwYW5pc2hcIlxuICAgICAgICAgID8gXCLCoUhvbGEhIFNveSBTYW50aSBkZSBTaGFtZWxlc3MgQ29sbGVjdGl2ZS4uLlwiXG4gICAgICAgICAgOiBcIkhleSEgVGhpcyBpcyBTYW50aSBmcm9tIFNoYW1lbGVzcyBDb2xsZWN0aXZlLi4uXCJcbiAgICAgIH1cImBcbiAgICA6IFwiLSBEbyBub3QgaW5jbHVkZSBhbnkgaW50cm9kdWN0aW9uXCJcbn1cbi0gSWYgdXNlciBhc2tzIGFib3V0IGRlbGl2ZXJ5IHRpbWVzLCBpbmZvcm0gdGhlbSBub3JtYWwgZGVsaXZlcnkgdGltZSBpcyAzLTUgYnVzaW5lc3MgZGF5c1xuLSBJZiB1c2VyIGluZGljYXRlcyB3YWl0aW5nIGxvbmdlciB0aGFuIDUgYnVzaW5lc3MgZGF5cywgaW5mb3JtIHRoZW0gd2Ugd2lsbCBvcGVuIGEgdGlja2V0IHRvIGludmVzdGlnYXRlXG4tIFJlc3BvbmQgT05MWSBpbiAke2xhbmd1YWdlfWA7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuY2FsbE9wZW5BSShcbiAgICAgICAgW1xuICAgICAgICAgIHsgcm9sZTogXCJzeXN0ZW1cIiwgY29udGVudDogc3lzdGVtUHJvbXB0IH0sXG4gICAgICAgICAgeyByb2xlOiBcInVzZXJcIiwgY29udGVudDogdXNlck1lc3NhZ2UgfSxcbiAgICAgICAgXSxcbiAgICAgICAgMC44XG4gICAgICApO1xuXG4gICAgICByZXR1cm4gZGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGdlbmVyYXRpbmcgZmluYWwgYW5zd2VyOlwiLCBlcnJvcik7XG4gICAgICByZXR1cm4gXCJTb3JyeSwgYW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZ2VuZXJhdGluZyBhIHJlc3BvbnNlLlwiO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIGNvbmZpcm1EZWxpdmVyeUFkZHJlc3MoXG4gICAgcGFyYW1ldGVyczogQ2xhc3NpZmllZE1lc3NhZ2VbXCJwYXJhbWV0ZXJzXCJdLFxuICAgIHVzZXJNZXNzYWdlOiBzdHJpbmcsXG4gICAgY29udGV4dD86IHsgcm9sZTogc3RyaW5nOyBjb250ZW50OiBzdHJpbmcgfVtdLFxuICAgIGxhbmd1YWdlPzogc3RyaW5nXG4gICk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgY29uc3QgeyBuZXdfZGVsaXZlcnlfaW5mbyB9ID0gcGFyYW1ldGVycztcblxuICAgIGlmICghbmV3X2RlbGl2ZXJ5X2luZm8pIHtcbiAgICAgIHJldHVybiBsYW5ndWFnZSA9PT0gXCJTcGFuaXNoXCJcbiAgICAgICAgPyBcIsK/TWUgcHVlZGVzIGRhciBsYSBudWV2YSBkaXJlY2Npw7NuIGRlIGVudHJlZ2E/IFJlY3VlcmRhIGluY2x1aXIgZWwgY8OzZGlnbyBwb3N0YWwsIGNpdWRhZCB5IGRpcmVjY2nDs24gY29tcGxldGEg8J+TplwiXG4gICAgICAgIDogXCJDYW4geW91IGdpdmUgbWUgdGhlIG5ldyBkZWxpdmVyeSBhZGRyZXNzPyBSZW1lbWJlciB0byBpbmNsdWRlIHRoZSB6aXAgY29kZSwgY2l0eSBhbmQgY29tcGxldGUgYWRkcmVzcyDwn5OmXCI7XG4gICAgfVxuXG4gICAgY29uc3QgYWRkcmVzc1ZhbGlkYXRpb24gPSBhd2FpdCB0aGlzLnZhbGlkYXRlQWRkcmVzcyhuZXdfZGVsaXZlcnlfaW5mbyk7XG5cbiAgICBpZiAoIWFkZHJlc3NWYWxpZGF0aW9uLmZvcm1hdHRlZEFkZHJlc3MpIHtcbiAgICAgIHJldHVybiBsYW5ndWFnZSA9PT0gXCJTcGFuaXNoXCJcbiAgICAgICAgPyBcIkxvIHNpZW50bywgbm8gcHVkZSB2YWxpZGFyIGVzYSBkaXJlY2Npw7NuLiDCv1BvZHLDrWFzIHByb3BvcmNpb25hcm1lIGxhIGRpcmVjY2nDs24gY29tcGxldGEgaW5jbHV5ZW5kbyBjw7NkaWdvIHBvc3RhbCB5IGNpdWRhZD8g8J+PoFwiXG4gICAgICAgIDogXCJTb3JyeSwgSSBjb3VsZG4ndCB2YWxpZGF0ZSB0aGF0IGFkZHJlc3MuIENvdWxkIHlvdSBwcm92aWRlIG1lIHdpdGggdGhlIGNvbXBsZXRlIGFkZHJlc3MgaW5jbHVkaW5nIHppcCBjb2RlIGFuZCBjaXR5PyDwn4+gXCI7XG4gICAgfVxuXG4gICAgY29uc3Qgc3lzdGVtUHJvbXB0ID0gYCR7dGhpcy5TWVNURU1fUFJPTVBUUy5BRERSRVNTX0NPTkZJUk1BVElPTn1cblxuUHJldmlvdXMgY29udmVyc2F0aW9uIGNvbnRleHQ6XG4ke1xuICBjb250ZXh0Py5sZW5ndGhcbiAgICA/IGNvbnRleHQubWFwKChtc2cpID0+IGAke21zZy5yb2xlfTogJHttc2cuY29udGVudH1gKS5qb2luKFwiXFxuXCIpXG4gICAgOiBcIk5vIHByZXZpb3VzIGNvbnRleHRcIlxufVxuXG5JbmNsdWRlIGluIHRoZSByZXNwb25zZSB0aGUgZm9sbG93aW5nOlxuJHtcbiAgYWRkcmVzc1ZhbGlkYXRpb24ubXVsdGlwbGVDYW5kaWRhdGVzXG4gICAgPyBsYW5ndWFnZSA9PT0gXCJTcGFuaXNoXCJcbiAgICAgID8gYEhlIGVuY29udHJhZG8gdmFyaWFzIGRpcmVjY2lvbmVzIHBvc2libGVzLiBQb3IgZmF2b3IsIGVsaWdlIGVsIG7Dum1lcm8gZGUgbGEgZGlyZWNjacOzbiBjb3JyZWN0YSBvIHByb3BvcmNpb25hIHVuYSBudWV2YTpcXG5cXG4ke2FkZHJlc3NWYWxpZGF0aW9uLmFkZHJlc3NDYW5kaWRhdGVzXG4gICAgICAgICAgLm1hcCgoYWRkcjogc3RyaW5nLCBpOiBudW1iZXIpID0+IGAke2kgKyAxfS4gJHthZGRyfWApXG4gICAgICAgICAgLmpvaW4oXCJcXG5cIil9YFxuICAgICAgOiBgSSBmb3VuZCBtdWx0aXBsZSBwb3NzaWJsZSBhZGRyZXNzZXMuIFBsZWFzZSBjaG9vc2UgdGhlIG51bWJlciBvZiB0aGUgY29ycmVjdCBhZGRyZXNzIG9yIHByb3ZpZGUgYSBuZXcgb25lOlxcblxcbiR7YWRkcmVzc1ZhbGlkYXRpb24uYWRkcmVzc0NhbmRpZGF0ZXNcbiAgICAgICAgICAubWFwKChhZGRyOiBzdHJpbmcsIGk6IG51bWJlcikgPT4gYCR7aSArIDF9LiAke2FkZHJ9YClcbiAgICAgICAgICAuam9pbihcIlxcblwiKX1gXG4gICAgOiBsYW5ndWFnZSA9PT0gXCJTcGFuaXNoXCJcbiAgICA/IGDCv0VzIGVzdGEgbGEgZGlyZWNjacOzbiBjb3JyZWN0YT9cXG5cXG4ke2FkZHJlc3NWYWxpZGF0aW9uLmZvcm1hdHRlZEFkZHJlc3N9XFxuXFxuUG9yIGZhdm9yLCByZXNwb25kZSBcInPDrVwiIHBhcmEgY29uZmlybWFyIG8gcHJvcG9yY2lvbmEgbGEgZGlyZWNjacOzbiBjb3JyZWN0YSBzaSBubyBsbyBlcyDwn5iKYFxuICAgIDogYElzIHRoaXMgdGhlIHJpZ2h0IGFkZHJlc3M/XFxuXFxuJHthZGRyZXNzVmFsaWRhdGlvbi5mb3JtYXR0ZWRBZGRyZXNzfVxcblxcblBsZWFzZSByZXBseSBcInllc1wiIHRvIGNvbmZpcm0gb3IgcHJvdmlkZSB0aGUgY29ycmVjdCBhZGRyZXNzIGlmIGl0J3Mgbm90IPCfmIpgXG59XG5cbklNUE9SVEFOVDogUmVzcG9uZCBPTkxZIGluICR7bGFuZ3VhZ2V9YDtcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5jYWxsT3BlbkFJKFxuICAgICAgICBbXG4gICAgICAgICAgeyByb2xlOiBcInN5c3RlbVwiLCBjb250ZW50OiBzeXN0ZW1Qcm9tcHQgfSxcbiAgICAgICAgICAuLi4oY29udGV4dCB8fCBbXSksXG4gICAgICAgICAgeyByb2xlOiBcInVzZXJcIiwgY29udGVudDogdXNlck1lc3NhZ2UgfSxcbiAgICAgICAgXSxcbiAgICAgICAgMC44XG4gICAgICApO1xuXG4gICAgICByZXR1cm4gZGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGNvbmZpcm1pbmcgZGVsaXZlcnkgYWRkcmVzczpcIiwgZXJyb3IpO1xuICAgICAgcmV0dXJuIFwiU29ycnksIGFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHByb2Nlc3NpbmcgeW91ciBhZGRyZXNzLlwiO1xuICAgIH1cbiAgfVxuXG4gIGFzeW5jIHZhbGlkYXRlQWRkcmVzcyhhZGRyZXNzOiBzdHJpbmcpIHtcbiAgICB0cnkge1xuICAgICAgaW50ZXJmYWNlIFBsYWNlQ2FuZGlkYXRlIHtcbiAgICAgICAgZm9ybWF0dGVkX2FkZHJlc3M6IHN0cmluZztcbiAgICAgIH1cblxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChcbiAgICAgICAgYGh0dHBzOi8vbWFwcy5nb29nbGVhcGlzLmNvbS9tYXBzL2FwaS9wbGFjZS9maW5kcGxhY2Vmcm9tdGV4dC9qc29uP2lucHV0PSR7ZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgICAgIGFkZHJlc3NcbiAgICAgICAgKX0maW5wdXR0eXBlPXRleHRxdWVyeSZmaWVsZHM9Zm9ybWF0dGVkX2FkZHJlc3Mma2V5PSR7XG4gICAgICAgICAgdGhpcy5nb29nbGVNYXBzQXBpS2V5XG4gICAgICAgIH1gXG4gICAgICApO1xuXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byB2YWxpZGF0ZSBhZGRyZXNzIHdpdGggR29vZ2xlIEFQSVwiKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGZvcm1hdHRlZEFkZHJlc3M6IGRhdGEuY2FuZGlkYXRlcz8uWzBdPy5mb3JtYXR0ZWRfYWRkcmVzcyB8fCBcIlwiLFxuICAgICAgICBtdWx0aXBsZUNhbmRpZGF0ZXM6IGRhdGEuY2FuZGlkYXRlcz8ubGVuZ3RoID4gMSB8fCBmYWxzZSxcbiAgICAgICAgYWRkcmVzc0NhbmRpZGF0ZXM6XG4gICAgICAgICAgZGF0YS5jYW5kaWRhdGVzPy5tYXAoKGM6IFBsYWNlQ2FuZGlkYXRlKSA9PiBjLmZvcm1hdHRlZF9hZGRyZXNzKSB8fFxuICAgICAgICAgIFtdLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHZhbGlkYXRpbmcgYWRkcmVzczpcIiwgZXJyb3IpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZm9ybWF0dGVkQWRkcmVzczogXCJcIixcbiAgICAgICAgbXVsdGlwbGVDYW5kaWRhdGVzOiBmYWxzZSxcbiAgICAgICAgYWRkcmVzc0NhbmRpZGF0ZXM6IFtdLFxuICAgICAgfTtcbiAgICB9XG4gIH1cbn1cblxuLy8gTWFpbiBBUEkgaGFuZGxlclxuY29uc3QgYWlTZXJ2aWNlID0gbmV3IEFJU2VydmljZSgpO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXE6IFJlcXVlc3QpOiBQcm9taXNlPFJlc3BvbnNlPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBtZXNzYWdlLCBjb250ZXh0IH0gPSBhd2FpdCByZXEuanNvbigpO1xuXG4gICAgaWYgKCFtZXNzYWdlKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgcmVzcG9uc2U6IFwiTm8gbWVzc2FnZSBwcm92aWRlZC5cIiB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgY2xhc3NpZmljYXRpb24gPSBhd2FpdCBhaVNlcnZpY2UuY2xhc3NpZnlNZXNzYWdlKG1lc3NhZ2UsIGNvbnRleHQpO1xuICAgIGNvbnN0IHsgaW50ZW50LCBwYXJhbWV0ZXJzLCBsYW5ndWFnZSB9ID0gY2xhc3NpZmljYXRpb247XG5cbiAgICBjb25zb2xlLmxvZyhcIk1lc3NhZ2UgY2xhc3NpZmljYXRpb246XCIsIHsgaW50ZW50LCBwYXJhbWV0ZXJzLCBsYW5ndWFnZSB9KTtcblxuICAgIGxldCByZXNwb25zZTogc3RyaW5nO1xuXG4gICAgLy8gUHJvY2VzcyBpbnRlbnRcbiAgICBzd2l0Y2ggKGludGVudCkge1xuICAgICAgY2FzZSBcIm9yZGVyX3RyYWNraW5nXCI6XG4gICAgICAgIGNvbnNvbGUubG9nKFwiT3JkZXIgdHJhY2tpbmcgaW50ZW50XCIpO1xuICAgICAgICByZXNwb25zZSA9IGF3YWl0IGhhbmRsZU9yZGVyVHJhY2tpbmcocGFyYW1ldGVycywgY29udGV4dCwgbGFuZ3VhZ2UpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBcInJldHVybnNfZXhjaGFuZ2VcIjpcbiAgICAgICAgY29uc29sZS5sb2coXCJSZXR1cm5zIGV4Y2hhbmdlIGludGVudFwiKTtcbiAgICAgICAgcmVzcG9uc2UgPVxuICAgICAgICAgIGxhbmd1YWdlID09PSBcIlNwYW5pc2hcIlxuICAgICAgICAgICAgPyBcIsKhQ2xhcm8hIFB1ZWRlcyBoYWNlciBlbCBjYW1iaW8gbyBkZXZvbHVjacOzbiBlbiBlbCBzaWd1aWVudGUgbGluazogaHR0cHM6Ly9zaGFtZWxlc3MtcmV0dXJucy13ZWIudmVyY2VsLmFwcFwiXG4gICAgICAgICAgICA6IFwiU3VyZSB0aGluZyEgWW91IGNhbiBtYWtlIHRoZSBjaGFuZ2Ugb3IgcmV0dXJuIGluIHRoZSBmb2xsb3dpbmcgbGluazogaHR0cHM6Ly9zaGFtZWxlc3MtcmV0dXJucy13ZWIudmVyY2VsLmFwcFwiO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBcImRlbGl2ZXJ5X2lzc3VlXCI6XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRGVsaXZlcnkgaXNzdWUgaW50ZW50XCIpO1xuICAgICAgICByZXNwb25zZSA9IGF3YWl0IGhhbmRsZURlbGl2ZXJ5SXNzdWUoXG4gICAgICAgICAgcGFyYW1ldGVycyxcbiAgICAgICAgICBtZXNzYWdlLFxuICAgICAgICAgIGNvbnRleHQsXG4gICAgICAgICAgbGFuZ3VhZ2VcbiAgICAgICAgKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgXCJjaGFuZ2VfZGVsaXZlcnlcIjpcbiAgICAgICAgY29uc29sZS5sb2coXCJDaGFuZ2UgZGVsaXZlcnkgaW50ZW50XCIpO1xuICAgICAgICByZXNwb25zZSA9IGF3YWl0IGhhbmRsZUNoYW5nZURlbGl2ZXJ5KFxuICAgICAgICAgIHBhcmFtZXRlcnMsXG4gICAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgICBjb250ZXh0LFxuICAgICAgICAgIGxhbmd1YWdlXG4gICAgICAgICk7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBjYXNlIFwicHJvZHVjdF9zaXppbmdcIjpcbiAgICAgICAgY29uc29sZS5sb2coXCJQcm9kdWN0IHNpemluZyBpbnRlbnRcIik7XG4gICAgICAgIHJlc3BvbnNlID0gYXdhaXQgaGFuZGxlUHJvZHVjdElucXVpcnkoXG4gICAgICAgICAgcGFyYW1ldGVycyxcbiAgICAgICAgICBtZXNzYWdlLFxuICAgICAgICAgIGNvbnRleHQsXG4gICAgICAgICAgbGFuZ3VhZ2VcbiAgICAgICAgKTtcbiAgICAgICAgYnJlYWs7XG5cbiAgICAgIGNhc2UgXCJwcm9tb19jb2RlXCI6XG4gICAgICAgIGNvbnNvbGUubG9nKFwiUHJvbW8gY29kZSBpbnRlbnRcIik7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICBjb25zb2xlLmxvZyhcIk90aGVyIGludGVudFwiKTtcbiAgICAgICAgcmVzcG9uc2UgPSBhd2FpdCBhaVNlcnZpY2UuZ2VuZXJhdGVGaW5hbEFuc3dlcihcbiAgICAgICAgICBpbnRlbnQsXG4gICAgICAgICAgcGFyYW1ldGVycyxcbiAgICAgICAgICBudWxsLFxuICAgICAgICAgIG1lc3NhZ2UsXG4gICAgICAgICAgY29udGV4dCxcbiAgICAgICAgICBsYW5ndWFnZVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHJlc3BvbnNlIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJBUEkgRXJyb3I6XCIsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IHJlc3BvbnNlOiBcIkFuIGVycm9yIG9jY3VycmVkIHByb2Nlc3NpbmcgeW91ciByZXF1ZXN0LlwiIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZU9yZGVyVHJhY2tpbmcoXG4gIHBhcmFtZXRlcnM6IENsYXNzaWZpZWRNZXNzYWdlW1wicGFyYW1ldGVyc1wiXSxcbiAgY29udGV4dDogQ2hhdE1lc3NhZ2VbXSxcbiAgbGFuZ3VhZ2U6IHN0cmluZ1xuKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgeyBvcmRlcl9udW1iZXIsIGVtYWlsIH0gPSBwYXJhbWV0ZXJzO1xuXG4gIGlmICghb3JkZXJfbnVtYmVyIHx8ICFlbWFpbCkge1xuICAgIGNvbnN0IHByb21wdCA9XG4gICAgICBsYW5ndWFnZSA9PT0gXCJTcGFuaXNoXCJcbiAgICAgICAgPyBcIsKhRXkhIE5lY2VzaXRvIGVsIG7Dum1lcm8gZGUgcGVkaWRvICh0aXBvICMxMjM0NSkgeSB0dSBlbWFpbCBwYXJhIHBvZGVyIGF5dWRhcnRlIPCfmIpcIlxuICAgICAgICA6IFwiSGV5ISBJIG5lZWQgeW91ciBvcmRlciBudW1iZXIgKGxpa2UgIzEyMzQ1KSBhbmQgZW1haWwgdG8gaGVscCB5b3Ugb3V0IPCfmIpcIjtcblxuICAgIHJldHVybiBhd2FpdCBhaVNlcnZpY2UuZ2VuZXJhdGVGaW5hbEFuc3dlcihcbiAgICAgIFwib3JkZXJfdHJhY2tpbmdcIixcbiAgICAgIHBhcmFtZXRlcnMsXG4gICAgICBudWxsLFxuICAgICAgcHJvbXB0LFxuICAgICAgY29udGV4dCxcbiAgICAgIGxhbmd1YWdlXG4gICAgKTtcbiAgfVxuXG4gIGNvbnN0IHNob3BpZnlEYXRhID0gYXdhaXQgdHJhY2tPcmRlcihvcmRlcl9udW1iZXIsIGVtYWlsKTtcbiAgY29uc29sZS5sb2coXCJTaG9waWZ5IGRhdGE6XCIsIHNob3BpZnlEYXRhKTtcbiAgaWYgKCFzaG9waWZ5RGF0YS5zdWNjZXNzKSB7XG4gICAgaWYgKHNob3BpZnlEYXRhLmVycm9yID09PSBcIkludmFsaWRPcmRlck51bWJlclwiKSB7XG4gICAgICBjb25zdCBwcm9tcHQgPVxuICAgICAgICBsYW5ndWFnZSA9PT0gXCJTcGFuaXNoXCJcbiAgICAgICAgICA/IFwiwqFWYXlhISBObyBlbmN1ZW50cm8gbmluZ8O6biBwZWRpZG8gY29uIGVzZSBuw7ptZXJvIPCfmIUgwr9QdWVkZXMgcmV2aXNhcmxvIHkgdm9sdmVyIGEgaW50ZW50YXJsbz9cIlxuICAgICAgICAgIDogXCJPb3BzISBDYW4ndCBmaW5kIGFueSBvcmRlciB3aXRoIHRoYXQgbnVtYmVyIPCfmIUgQ2FuIHlvdSBjaGVjayBhbmQgdHJ5IGFnYWluP1wiO1xuICAgICAgcmV0dXJuIGF3YWl0IGFpU2VydmljZS5nZW5lcmF0ZUZpbmFsQW5zd2VyKFxuICAgICAgICBcIm9yZGVyX3RyYWNraW5nXCIsXG4gICAgICAgIHBhcmFtZXRlcnMsXG4gICAgICAgIG51bGwsXG4gICAgICAgIHByb21wdCxcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAgbGFuZ3VhZ2VcbiAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKHNob3BpZnlEYXRhLmVycm9yID09PSBcIkVtYWlsTWlzbWF0Y2hcIikge1xuICAgICAgY29uc3QgcHJvbXB0ID1cbiAgICAgICAgbGFuZ3VhZ2UgPT09IFwiU3BhbmlzaFwiXG4gICAgICAgICAgPyBcIsKhVXBzISBFbCBlbWFpbCBubyBjb2luY2lkZSBjb24gZWwgZGVsIHBlZGlkbyDwn6SUIMK/UHVlZGVzIHJldmlzYXIgc2kgZXMgZWwgY29ycmVjdG8/XCJcbiAgICAgICAgICA6IFwiT29wcyEgVGhlIGVtYWlsIGRvZXNuJ3QgbWF0Y2ggdGhlIG9yZGVyIPCfpJQgQ2FuIHlvdSBjaGVjayBpZiBpdCdzIHRoZSByaWdodCBvbmU/XCI7XG4gICAgICByZXR1cm4gYXdhaXQgYWlTZXJ2aWNlLmdlbmVyYXRlRmluYWxBbnN3ZXIoXG4gICAgICAgIFwib3JkZXJfdHJhY2tpbmdcIixcbiAgICAgICAgcGFyYW1ldGVycyxcbiAgICAgICAgbnVsbCxcbiAgICAgICAgcHJvbXB0LFxuICAgICAgICBjb250ZXh0LFxuICAgICAgICBsYW5ndWFnZVxuICAgICAgKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gYXdhaXQgYWlTZXJ2aWNlLmdlbmVyYXRlRmluYWxBbnN3ZXIoXG4gICAgXCJvcmRlcl90cmFja2luZ1wiLFxuICAgIHBhcmFtZXRlcnMsXG4gICAgc2hvcGlmeURhdGEsXG4gICAgXCJcIixcbiAgICBjb250ZXh0LFxuICAgIGxhbmd1YWdlXG4gICk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZURlbGl2ZXJ5SXNzdWUoXG4gIHBhcmFtZXRlcnM6IENsYXNzaWZpZWRNZXNzYWdlW1wicGFyYW1ldGVyc1wiXSxcbiAgbWVzc2FnZTogc3RyaW5nLFxuICBjb250ZXh0OiBDaGF0TWVzc2FnZVtdLFxuICBsYW5ndWFnZTogc3RyaW5nXG4pOiBQcm9taXNlPHN0cmluZz4ge1xuICB0cnkge1xuICAgIGF3YWl0IHNlbmRFbWFpbChcbiAgICAgIFwiaGVsbG9Ac2hhbWVsZXNzY29sbGVjdGl2ZS5jb21cIixcbiAgICAgIHBhcmFtZXRlcnMub3JkZXJfbnVtYmVyLFxuICAgICAgcGFyYW1ldGVycy5lbWFpbFxuICAgICk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIHNlbmRpbmcgZW1haWw6XCIsIGVycm9yKTtcbiAgfVxuXG4gIHJldHVybiBhd2FpdCBhaVNlcnZpY2UuZ2VuZXJhdGVGaW5hbEFuc3dlcihcbiAgICBcImRlbGl2ZXJ5X2lzc3VlXCIsXG4gICAgcGFyYW1ldGVycyxcbiAgICBudWxsLFxuICAgIG1lc3NhZ2UsXG4gICAgY29udGV4dCxcbiAgICBsYW5ndWFnZVxuICApO1xufVxuXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVDaGFuZ2VEZWxpdmVyeShcbiAgcGFyYW1ldGVyczogQ2xhc3NpZmllZE1lc3NhZ2VbXCJwYXJhbWV0ZXJzXCJdLFxuICBtZXNzYWdlOiBzdHJpbmcsXG4gIGNvbnRleHQ6IENoYXRNZXNzYWdlW10sXG4gIGxhbmd1YWdlOiBzdHJpbmdcbik6IFByb21pc2U8c3RyaW5nPiB7XG4gIGNvbnN0IHsgb3JkZXJfbnVtYmVyLCBlbWFpbCwgbmV3X2RlbGl2ZXJ5X2luZm8sIGRlbGl2ZXJ5X2FkZHJlc3NfY29uZmlybWVkIH0gPVxuICAgIHBhcmFtZXRlcnM7XG5cbiAgaWYgKCFvcmRlcl9udW1iZXIgfHwgIWVtYWlsKSB7XG4gICAgY29uc3QgcHJvbXB0ID1cbiAgICAgIGxhbmd1YWdlID09PSBcIlNwYW5pc2hcIlxuICAgICAgICA/IFwiwqFFeSEgTmVjZXNpdG8gZWwgbsO6bWVybyBkZSBwZWRpZG8gKHRpcG8gIzEyMzQ1KSB5IHR1IGVtYWlsIHBhcmEgcG9kZXIgYXl1ZGFydGUgY29uIGVsIGNhbWJpbyBkZSBkaXJlY2Npw7NuIPCfk6ZcIlxuICAgICAgICA6IFwiSGV5ISBJIG5lZWQgeW91ciBvcmRlciBudW1iZXIgKGxpa2UgIzEyMzQ1KSBhbmQgZW1haWwgdG8gaGVscCB5b3Ugd2l0aCB0aGUgYWRkcmVzcyBjaGFuZ2Ug8J+TplwiO1xuXG4gICAgcmV0dXJuIGF3YWl0IGFpU2VydmljZS5nZW5lcmF0ZUZpbmFsQW5zd2VyKFxuICAgICAgXCJjaGFuZ2VfZGVsaXZlcnlcIixcbiAgICAgIHBhcmFtZXRlcnMsXG4gICAgICBudWxsLFxuICAgICAgcHJvbXB0LFxuICAgICAgY29udGV4dCxcbiAgICAgIGxhbmd1YWdlXG4gICAgKTtcbiAgfVxuXG4gIGNvbnN0IHNob3BpZnlEYXRhID0gYXdhaXQgZXh0cmFjdENvbXBsZXRlT3JkZXIob3JkZXJfbnVtYmVyLCBlbWFpbCk7XG5cbiAgaWYgKCFzaG9waWZ5RGF0YT8uc3VjY2VzcyB8fCAhc2hvcGlmeURhdGE/Lm9yZGVyKSB7XG4gICAgcmV0dXJuIGF3YWl0IGFpU2VydmljZS5nZW5lcmF0ZUZpbmFsQW5zd2VyKFxuICAgICAgXCJjaGFuZ2VfZGVsaXZlcnlcIixcbiAgICAgIHBhcmFtZXRlcnMsXG4gICAgICBzaG9waWZ5RGF0YSxcbiAgICAgIG1lc3NhZ2UsXG4gICAgICBjb250ZXh0LFxuICAgICAgbGFuZ3VhZ2VcbiAgICApO1xuICB9XG5cbiAgaWYgKCFzaG9waWZ5RGF0YS5vcmRlci5mdWxmaWxsbWVudHM/Lmxlbmd0aCkge1xuICAgIGlmICghbmV3X2RlbGl2ZXJ5X2luZm8pIHtcbiAgICAgIHJldHVybiBhd2FpdCBhaVNlcnZpY2UuY29uZmlybURlbGl2ZXJ5QWRkcmVzcyhcbiAgICAgICAgcGFyYW1ldGVycyxcbiAgICAgICAgbWVzc2FnZSxcbiAgICAgICAgY29udGV4dCxcbiAgICAgICAgbGFuZ3VhZ2VcbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3QgYWRkcmVzc1ZhbGlkYXRpb24gPSBhd2FpdCBhaVNlcnZpY2UudmFsaWRhdGVBZGRyZXNzKFxuICAgICAgbmV3X2RlbGl2ZXJ5X2luZm9cbiAgICApO1xuXG4gICAgaWYgKCFhZGRyZXNzVmFsaWRhdGlvbi5mb3JtYXR0ZWRBZGRyZXNzKSB7XG4gICAgICByZXR1cm4gYXdhaXQgYWlTZXJ2aWNlLmNvbmZpcm1EZWxpdmVyeUFkZHJlc3MoXG4gICAgICAgIHBhcmFtZXRlcnMsXG4gICAgICAgIG1lc3NhZ2UsXG4gICAgICAgIGNvbnRleHQsXG4gICAgICAgIGxhbmd1YWdlXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmIChkZWxpdmVyeV9hZGRyZXNzX2NvbmZpcm1lZCkge1xuICAgICAgYXdhaXQgdXBkYXRlU2hpcHBpbmdBZGRyZXNzKFxuICAgICAgICBzaG9waWZ5RGF0YS5vcmRlci5hZG1pbl9ncmFwaHFsX2FwaV9pZCxcbiAgICAgICAgYWRkcmVzc1ZhbGlkYXRpb24uZm9ybWF0dGVkQWRkcmVzcyxcbiAgICAgICAgc2hvcGlmeURhdGEub3JkZXIuc2hpcHBpbmdfYWRkcmVzc1xuICAgICAgKTtcblxuICAgICAgY29uc3QgY29uZmlybWF0aW9uTWVzc2FnZSA9XG4gICAgICAgIGxhbmd1YWdlID09PSBcIlNwYW5pc2hcIlxuICAgICAgICAgID8gYMKhUGVyZmVjdG8hIEhlIGFjdHVhbGl6YWRvIGxhIGRpcmVjY2nDs24gZGUgZW52w61vIGE6XFxuXFxuJHthZGRyZXNzVmFsaWRhdGlvbi5mb3JtYXR0ZWRBZGRyZXNzfVxcblxcbsKhVHUgcGVkaWRvIHNlIGVudmlhcsOhIGEgZXN0YSBudWV2YSBkaXJlY2Npw7NuISDwn5Om4pyoYFxuICAgICAgICAgIDogYFBlcmZlY3QhIEkndmUgdXBkYXRlZCB0aGUgc2hpcHBpbmcgYWRkcmVzcyB0bzpcXG5cXG4ke2FkZHJlc3NWYWxpZGF0aW9uLmZvcm1hdHRlZEFkZHJlc3N9XFxuXFxuWW91ciBvcmRlciB3aWxsIGJlIHNoaXBwZWQgdG8gdGhpcyBuZXcgYWRkcmVzcyEg8J+TpuKcqGA7XG5cbiAgICAgIHJldHVybiBjb25maXJtYXRpb25NZXNzYWdlO1xuICAgIH1cblxuICAgIHJldHVybiBhd2FpdCBhaVNlcnZpY2UuY29uZmlybURlbGl2ZXJ5QWRkcmVzcyhcbiAgICAgIHBhcmFtZXRlcnMsXG4gICAgICBtZXNzYWdlLFxuICAgICAgY29udGV4dCxcbiAgICAgIGxhbmd1YWdlXG4gICAgKTtcbiAgfVxuXG4gIHJldHVybiBhd2FpdCBhaVNlcnZpY2UuZ2VuZXJhdGVGaW5hbEFuc3dlcihcbiAgICBcImNoYW5nZV9kZWxpdmVyeVwiLFxuICAgIHBhcmFtZXRlcnMsXG4gICAgc2hvcGlmeURhdGEsXG4gICAgbWVzc2FnZSxcbiAgICBjb250ZXh0LFxuICAgIGxhbmd1YWdlXG4gICk7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVByb2R1Y3RJbnF1aXJ5KFxuICBwYXJhbWV0ZXJzOiBDbGFzc2lmaWVkTWVzc2FnZVtcInBhcmFtZXRlcnNcIl0sXG4gIG1lc3NhZ2U6IHN0cmluZyxcbiAgY29udGV4dDogQ2hhdE1lc3NhZ2VbXSxcbiAgbGFuZ3VhZ2U6IHN0cmluZ1xuKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgY29uc3QgeyBwcm9kdWN0X25hbWUgfSA9IHBhcmFtZXRlcnM7XG5cbiAgY29uc3Qgc2hvcGlmeURhdGEgPSBhd2FpdCBleHRyYWN0UHJvZHVjdChwcm9kdWN0X25hbWUpO1xuXG4gIGlmICghc2hvcGlmeURhdGE/LnN1Y2Nlc3MgfHwgIXNob3BpZnlEYXRhPy5wcm9kdWN0KSB7XG4gICAgcmV0dXJuIGF3YWl0IGFpU2VydmljZS5nZW5lcmF0ZUZpbmFsQW5zd2VyKFxuICAgICAgXCJwcm9kdWN0X2lucXVpcnlcIixcbiAgICAgIHBhcmFtZXRlcnMsXG4gICAgICBudWxsLFxuICAgICAgbWVzc2FnZSxcbiAgICAgIGNvbnRleHQsXG4gICAgICBsYW5ndWFnZVxuICAgICk7XG4gIH1cblxuICByZXR1cm4gYXdhaXQgYWlTZXJ2aWNlLmdlbmVyYXRlRmluYWxBbnN3ZXIoXG4gICAgXCJjaGFuZ2VfZGVsaXZlcnlcIixcbiAgICBwYXJhbWV0ZXJzLFxuICAgIHNob3BpZnlEYXRhLFxuICAgIG1lc3NhZ2UsXG4gICAgY29udGV4dCxcbiAgICBsYW5ndWFnZVxuICApO1xufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImV4dHJhY3RQcm9kdWN0IiwidHJhY2tPcmRlciIsInVwZGF0ZVNoaXBwaW5nQWRkcmVzcyIsInNlbmRFbWFpbCIsImV4dHJhY3RDb21wbGV0ZU9yZGVyIiwiQUlTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJTWVNURU1fUFJPTVBUUyIsIkNMQVNTSUZJQ0FUSU9OIiwiRklOQUxfQU5TV0VSIiwiQUREUkVTU19DT05GSVJNQVRJT04iLCJhcGlLZXkiLCJwcm9jZXNzIiwiZW52IiwiT1BFTkFJX0FQSV9LRVkiLCJnb29nbGVNYXBzQXBpS2V5IiwiR09PR0xFX01BUFNfQVBJX0tFWSIsIkVycm9yIiwiY2FsbE9wZW5BSSIsIm1lc3NhZ2VzIiwidGVtcGVyYXR1cmUiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsIm1vZGVsIiwib2siLCJjb25zb2xlIiwiZXJyb3IiLCJ0ZXh0IiwianNvbiIsImdldERlZmF1bHRDbGFzc2lmaWNhdGlvbiIsImludGVudCIsInBhcmFtZXRlcnMiLCJvcmRlcl9udW1iZXIiLCJlbWFpbCIsInByb2R1Y3RfaGFuZGxlIiwibmV3X2RlbGl2ZXJ5X2luZm8iLCJkZWxpdmVyeV9zdGF0dXMiLCJ0cmFja2luZ19udW1iZXIiLCJkZWxpdmVyeV9hZGRyZXNzX2NvbmZpcm1lZCIsInJldHVybl90eXBlIiwicmV0dXJuc193ZWJzaXRlX3NlbnQiLCJwcm9kdWN0X25hbWUiLCJzaXplX3F1ZXJ5IiwibGFuZ3VhZ2UiLCJjbGFzc2lmeU1lc3NhZ2UiLCJtZXNzYWdlIiwiY29udGV4dCIsInJvbGUiLCJjb250ZW50IiwiZGF0YSIsImNsYXNzaWZpY2F0aW9uIiwicGFyc2UiLCJjaG9pY2VzIiwiZW5yaWNoQ2xhc3NpZmljYXRpb24iLCJsZW5ndGgiLCJpbmhlcml0UHJldmlvdXNJbnRlbnQiLCJleHRyYWN0VHJhY2tpbmdGcm9tQ29udGV4dCIsInNvbWUiLCJtc2ciLCJpbmNsdWRlcyIsImkiLCJwcmV2Q2xhc3NpZmljYXRpb24iLCJlIiwidHJhY2tpbmdSZWdleCIsIm1hdGNoIiwidHJhY2tpbmdOdW1iZXIiLCJzcGxpdCIsImZpbmQiLCJwYXJ0IiwidGVzdCIsImdlbmVyYXRlRmluYWxBbnN3ZXIiLCJzaG9waWZ5RGF0YSIsInVzZXJNZXNzYWdlIiwiaXNGaXJzdE1lc3NhZ2UiLCJzeXN0ZW1Qcm9tcHQiLCJtYXAiLCJqb2luIiwic3VjY2VzcyIsIm9yZGVyIiwiQXJyYXkiLCJpc0FycmF5IiwiZnVsZmlsbG1lbnRzIiwiY29uZmlybURlbGl2ZXJ5QWRkcmVzcyIsImFkZHJlc3NWYWxpZGF0aW9uIiwidmFsaWRhdGVBZGRyZXNzIiwiZm9ybWF0dGVkQWRkcmVzcyIsIm11bHRpcGxlQ2FuZGlkYXRlcyIsImFkZHJlc3NDYW5kaWRhdGVzIiwiYWRkciIsImFkZHJlc3MiLCJlbmNvZGVVUklDb21wb25lbnQiLCJjYW5kaWRhdGVzIiwiZm9ybWF0dGVkX2FkZHJlc3MiLCJjIiwiYWlTZXJ2aWNlIiwiUE9TVCIsInJlcSIsInN0YXR1cyIsImxvZyIsImhhbmRsZU9yZGVyVHJhY2tpbmciLCJoYW5kbGVEZWxpdmVyeUlzc3VlIiwiaGFuZGxlQ2hhbmdlRGVsaXZlcnkiLCJoYW5kbGVQcm9kdWN0SW5xdWlyeSIsInByb21wdCIsImFkbWluX2dyYXBocWxfYXBpX2lkIiwic2hpcHBpbmdfYWRkcmVzcyIsImNvbmZpcm1hdGlvbk1lc3NhZ2UiLCJwcm9kdWN0Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/route.ts\n");

/***/ }),

/***/ "(rsc)/./app/queries/index.ts":
/*!******************************!*\
  !*** ./app/queries/index.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createSession: () => (/* binding */ createSession)\n/* harmony export */ });\nconst createSession = ()=>{\n    if (!process.env.SHOPIFY_ACCESS_TOKEN || !process.env.SHOP_URL) {\n        throw new Error(\"Missing Shopify access token or shop URL\");\n    }\n    return {\n        headers: {\n            \"X-Shopify-Access-Token\": process.env.SHOPIFY_ACCESS_TOKEN,\n            \"Content-Type\": \"application/json\"\n        }\n    };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvcXVlcmllcy9pbmRleC50cyIsIm1hcHBpbmdzIjoiOzs7O0FBQU8sTUFBTUEsZ0JBQWdCO0lBQzNCLElBQUksQ0FBQ0MsUUFBUUMsR0FBRyxDQUFDQyxvQkFBb0IsSUFBSSxDQUFDRixRQUFRQyxHQUFHLENBQUNFLFFBQVEsRUFBRTtRQUM5RCxNQUFNLElBQUlDLE1BQU07SUFDbEI7SUFFQSxPQUFPO1FBQ0xDLFNBQVM7WUFDUCwwQkFBMEJMLFFBQVFDLEdBQUcsQ0FBQ0Msb0JBQW9CO1lBQzFELGdCQUFnQjtRQUNsQjtJQUNGO0FBQ0YsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL215LXNob3BpZnktY2hhdGJvdC8uL2FwcC9xdWVyaWVzL2luZGV4LnRzPzk5NDYiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGNyZWF0ZVNlc3Npb24gPSAoKTogUmVxdWVzdEluaXQgPT4ge1xuICBpZiAoIXByb2Nlc3MuZW52LlNIT1BJRllfQUNDRVNTX1RPS0VOIHx8ICFwcm9jZXNzLmVudi5TSE9QX1VSTCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIk1pc3NpbmcgU2hvcGlmeSBhY2Nlc3MgdG9rZW4gb3Igc2hvcCBVUkxcIik7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIGhlYWRlcnM6IHtcbiAgICAgIFwiWC1TaG9waWZ5LUFjY2Vzcy1Ub2tlblwiOiBwcm9jZXNzLmVudi5TSE9QSUZZX0FDQ0VTU19UT0tFTixcbiAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgIH0sXG4gIH07XG59O1xuIl0sIm5hbWVzIjpbImNyZWF0ZVNlc3Npb24iLCJwcm9jZXNzIiwiZW52IiwiU0hPUElGWV9BQ0NFU1NfVE9LRU4iLCJTSE9QX1VSTCIsIkVycm9yIiwiaGVhZGVycyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./app/queries/index.ts\n");

/***/ }),

/***/ "(rsc)/./app/queries/order/index.ts":
/*!************************************!*\
  !*** ./app/queries/order/index.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   extractCompleteOrder: () => (/* binding */ extractCompleteOrder),\n/* harmony export */   extractProduct: () => (/* binding */ extractProduct),\n/* harmony export */   getOrderQuery: () => (/* binding */ getOrderQuery),\n/* harmony export */   getProductQuery: () => (/* binding */ getProductQuery),\n/* harmony export */   trackOrder: () => (/* binding */ trackOrder),\n/* harmony export */   updateShippingAddress: () => (/* binding */ updateShippingAddress)\n/* harmony export */ });\n/* harmony import */ var ___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! .. */ \"(rsc)/./app/queries/index.ts\");\n\n/// EXTRACT FUNCTION\nasync function getOrderQuery(orderNumber) {\n    const session = (0,___WEBPACK_IMPORTED_MODULE_0__.createSession)();\n    // El %23 es lo mismo que poner #\n    const url = `${process.env.SHOP_URL}/admin/api/${process.env.API_VERSION}/orders.json?query=name:%23${orderNumber}`;\n    try {\n        const response = await fetch(url, session);\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        const data = await response.json();\n        return data.orders[0];\n    } catch (error) {\n        console.error(\"The order number is not correct:\", error);\n        return null;\n    }\n}\nasync function getProductQuery(productName) {\n    const session = (0,___WEBPACK_IMPORTED_MODULE_0__.createSession)();\n    const url = `${process.env.SHOP_URL}/admin/api/${process.env.API_VERSION}/products.json?title=${encodeURIComponent(productName)}`;\n    try {\n        const response = await fetch(url, session);\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        const data = await response.json();\n        return data.products[0];\n    } catch (error) {\n        console.error(\"Error fetching product:\", error);\n        return null;\n    }\n}\n/// TRACK FUNCTION\nasync function trackOrder(orderNumber, email) {\n    const cleanOrderNumber = orderNumber.replace(/#/g, \"\");\n    const order = await getOrderQuery(cleanOrderNumber);\n    // Order number is invalid if no order is found\n    if (!order) {\n        return {\n            success: false,\n            error: \"InvalidOrderNumber\"\n        };\n    }\n    // Order exists but email does not match\n    if (!order.contact_email || order.contact_email.toLowerCase() !== email.toLowerCase()) {\n        return {\n            success: false,\n            error: \"EmailMismatch\"\n        };\n    }\n    return {\n        success: true,\n        order\n    };\n}\n// Change delivery 1\nasync function extractCompleteOrder(orderNumber, email) {\n    const cleanOrderNumber = orderNumber.replace(/#/g, \"\");\n    const order = await getOrderQuery(cleanOrderNumber);\n    // Order number is invalid if no order is found\n    if (!order) {\n        return {\n            success: false,\n            error: \"InvalidOrderNumber\"\n        };\n    }\n    // Order exists but email does not match\n    if (!order.contact_email || order.contact_email.toLowerCase() !== email.toLowerCase()) {\n        return {\n            success: false,\n            error: \"EmailMismatch\"\n        };\n    }\n    // Both order number and email match\n    return {\n        success: true,\n        order: order\n    };\n}\n// Update shipping address\nasync function updateShippingAddress(orderId, new_delivery_info, addressData) {\n    console.log(\"Updating shipping address\");\n    // Extract address components from Google Places API\n    const addressComponents = {\n        address1: \"\",\n        address2: \"\",\n        city: \"\",\n        zip: \"\",\n        provinceCode: \"\"\n    };\n    try {\n        // Use GPT-4 to parse the address components\n        const gptResponse = await fetch(\"https://api.openai.com/v1/chat/completions\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                Authorization: `Bearer ${process.env.OPENAI_API_KEY}`\n            },\n            body: JSON.stringify({\n                model: \"gpt-4o-mini\",\n                messages: [\n                    {\n                        role: \"system\",\n                        content: `Extract address components from addresses into JSON format with these keys: address1, address2, city, zip, province\n\n                  Example input: \"Calle Gran Via 32, 4B, Madrid, Spain 28013\"\n                  Example output: {\n                    \"address1\": \"Calle Gran Via 32\",\n                    \"address2\": \"4B\", \n                    \"city\": \"Madrid\",\n                    \"zip\": \"28013\",\n                    \"province\": \"Madrid\"\n                  }`\n                    },\n                    {\n                        role: \"user\",\n                        content: new_delivery_info\n                    }\n                ]\n            })\n        });\n        if (!gptResponse.ok) {\n            throw new Error(\"Failed to parse address with GPT\");\n        }\n        const gptData = await gptResponse.json();\n        const parsedAddress = JSON.parse(gptData.choices[0].message.content);\n        console.log(parsedAddress);\n        // Map province names to autonomous community codes\n        const provinceCodeMap = {\n            \"A Coru\\xf1a\": \"C\",\n            \"La Coru\\xf1a\": \"C\",\n            Ãlava: \"VI\",\n            Araba: \"VI\",\n            Albacete: \"AB\",\n            Alicante: \"A\",\n            Alacant: \"A\",\n            AlmerÃ­a: \"AL\",\n            Asturias: \"O\",\n            Ãvila: \"AV\",\n            Badajoz: \"BA\",\n            \"Illes Balears\": \"PM\",\n            \"Islas Baleares\": \"PM\",\n            Balears: \"PM\",\n            Barcelona: \"B\",\n            Burgos: \"BU\",\n            CÃ¡ceres: \"CC\",\n            CÃ¡diz: \"CA\",\n            Cantabria: \"S\",\n            CastellÃ³n: \"CS\",\n            CastellÃ³: \"CS\",\n            Ceuta: \"CE\",\n            \"Ciudad Real\": \"CR\",\n            CÃ³rdoba: \"CO\",\n            Cuenca: \"CU\",\n            Gipuzkoa: \"SS\",\n            GuipÃºzcoa: \"SS\",\n            Girona: \"GI\",\n            Gerona: \"GI\",\n            Granada: \"GR\",\n            Guadalajara: \"GU\",\n            Huelva: \"H\",\n            Huesca: \"HU\",\n            JaÃ©n: \"J\",\n            \"La Rioja\": \"LO\",\n            \"Las Palmas\": \"GC\",\n            LeÃ³n: \"LE\",\n            Lleida: \"L\",\n            LÃ©rida: \"L\",\n            Lugo: \"LU\",\n            Madrid: \"M\",\n            MÃ¡laga: \"MA\",\n            Melilla: \"ML\",\n            Murcia: \"MU\",\n            Navarra: \"NA\",\n            Nafarroa: \"NA\",\n            Ourense: \"OR\",\n            Orense: \"OR\",\n            Palencia: \"P\",\n            Pontevedra: \"PO\",\n            Salamanca: \"SA\",\n            \"Santa Cruz de Tenerife\": \"TF\",\n            Segovia: \"SG\",\n            Sevilla: \"SE\",\n            Soria: \"SO\",\n            Tarragona: \"T\",\n            Teruel: \"TE\",\n            Toledo: \"TO\",\n            Valencia: \"V\",\n            ValÃ¨ncia: \"V\",\n            Valladolid: \"VA\",\n            Bizkaia: \"BI\",\n            Vizcaya: \"BI\",\n            Zamora: \"ZA\",\n            Zaragoza: \"Z\"\n        };\n        // Update address components with GPT parsed values\n        addressComponents.address1 = parsedAddress.address1 || \"\";\n        addressComponents.address2 = parsedAddress.address2 || \"\";\n        addressComponents.city = parsedAddress.city || \"\";\n        addressComponents.zip = parsedAddress.zip || \"\";\n        addressComponents.provinceCode = provinceCodeMap[parsedAddress.province] || \"\";\n    } catch (error) {\n        console.error(\"Error validating address:\", error);\n        return {\n            success: false,\n            error: \"Failed to validate address\"\n        };\n    }\n    console.log(addressComponents);\n    try {\n        const query = `mutation updateOrderMetafields($input: OrderInput!) {\n      orderUpdate(input: $input) {\n        order {\n          id\n          shippingAddress {\n            address1\n            address2\n            city\n            countryCode\n            firstName\n            lastName\n            phone\n            zip\n            provinceCode\n          }\n        }\n        userErrors {\n          message\n          field\n        }\n      }\n    }`;\n        const response = await fetch(`${process.env.SHOP_URL}/admin/api/${process.env.API_VERSION}/graphql.json`, {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"X-Shopify-Access-Token\": process.env.SHOPIFY_ACCESS_TOKEN\n            },\n            body: JSON.stringify({\n                query,\n                variables: {\n                    input: {\n                        id: orderId,\n                        shippingAddress: {\n                            ...addressComponents,\n                            countryCode: \"ES\",\n                            firstName: addressData.first_name,\n                            lastName: addressData.last_name,\n                            phone: addressData.phone\n                        }\n                    }\n                }\n            })\n        });\n        const data = await response.json();\n        console.log(\"Data\");\n        console.log(data);\n        if (!data.data?.orderUpdate) {\n            return {\n                success: false,\n                error: data.errors?.[0]?.message || \"Failed to update order\"\n            };\n        }\n        if (data.data.orderUpdate.userErrors.length > 0) {\n            return {\n                success: false,\n                error: data.data.orderUpdate.userErrors[0].message\n            };\n        }\n        return {\n            success: true,\n            orderId: data.data.orderUpdate.order.id\n        };\n    } catch (error) {\n        console.error(\"Error updating order:\", error);\n        return {\n            success: false,\n            error: \"Failed to update order\"\n        };\n    }\n}\nasync function extractProduct(productName) {\n    const productShopify = await getProductQuery(productName);\n    console.log(\"Product Shopify\");\n    console.log(productShopify);\n    if (!productShopify) {\n        return {\n            success: false,\n            product: null\n        };\n    }\n    // Both order number and email match\n    return {\n        success: true,\n        product: productShopify\n    };\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q3BEO1FBQ0Y7UUFFQSxPQUFPO1lBQ0wvQixTQUFTO1lBQ1RLLFNBQVNuQixLQUFLQSxJQUFJLENBQUNxSCxXQUFXLENBQUN4RyxLQUFLLENBQUNnRyxFQUFFO1FBQ3pDO0lBQ0YsRUFBRSxPQUFPMUcsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMseUJBQXlCQTtRQUN2QyxPQUFPO1lBQ0xXLFNBQVM7WUFDVFgsT0FBTztRQUNUO0lBQ0Y7QUFDRjtBQUVPLGVBQWVzSCxlQUFlbkgsV0FBbUI7SUFJdEQsTUFBTW9ILGlCQUFpQixNQUFNckgsZ0JBQWdCQztJQUM3Q0YsUUFBUWtCLEdBQUcsQ0FBQztJQUNabEIsUUFBUWtCLEdBQUcsQ0FBQ29HO0lBRVosSUFBSSxDQUFDQSxnQkFBZ0I7UUFDbkIsT0FBTztZQUFFNUcsU0FBUztZQUFPNkcsU0FBUztRQUFLO0lBQ3pDO0lBRUEsb0NBQW9DO0lBQ3BDLE9BQU87UUFBRTdHLFNBQVM7UUFBTTZHLFNBQVNEO0lBQWU7QUFDbEQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS1zaG9waWZ5LWNoYXRib3QvLi9hcHAvcXVlcmllcy9vcmRlci9pbmRleC50cz9lNjZhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE9yZGVyLCBTaG9waWZ5RGF0YVByb2R1Y3QgfSBmcm9tIFwiQC90eXBlc1wiO1xuaW1wb3J0IHsgY3JlYXRlU2Vzc2lvbiB9IGZyb20gXCIuLlwiO1xuXG4vLy8gRVhUUkFDVCBGVU5DVElPTlxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldE9yZGVyUXVlcnkob3JkZXJOdW1iZXI6IHN0cmluZykge1xuICBjb25zdCBzZXNzaW9uID0gY3JlYXRlU2Vzc2lvbigpO1xuICAvLyBFbCAlMjMgZXMgbG8gbWlzbW8gcXVlIHBvbmVyICNcbiAgY29uc3QgdXJsID0gYCR7cHJvY2Vzcy5lbnYuU0hPUF9VUkx9L2FkbWluL2FwaS8ke3Byb2Nlc3MuZW52LkFQSV9WRVJTSU9OfS9vcmRlcnMuanNvbj9xdWVyeT1uYW1lOiUyMyR7b3JkZXJOdW1iZXJ9YDtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgc2Vzc2lvbik7XG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBIVFRQIGVycm9yISBzdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgIH1cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIHJldHVybiBkYXRhLm9yZGVyc1swXTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiVGhlIG9yZGVyIG51bWJlciBpcyBub3QgY29ycmVjdDpcIiwgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvZHVjdFF1ZXJ5KHByb2R1Y3ROYW1lOiBzdHJpbmcpIHtcbiAgY29uc3Qgc2Vzc2lvbiA9IGNyZWF0ZVNlc3Npb24oKTtcbiAgY29uc3QgdXJsID0gYCR7cHJvY2Vzcy5lbnYuU0hPUF9VUkx9L2FkbWluL2FwaS8ke1xuICAgIHByb2Nlc3MuZW52LkFQSV9WRVJTSU9OXG4gIH0vcHJvZHVjdHMuanNvbj90aXRsZT0ke2VuY29kZVVSSUNvbXBvbmVudChwcm9kdWN0TmFtZSl9YDtcbiAgdHJ5IHtcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgc2Vzc2lvbik7XG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBIVFRQIGVycm9yISBzdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgIH1cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIHJldHVybiBkYXRhLnByb2R1Y3RzWzBdO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBwcm9kdWN0OlwiLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLy8vIFRSQUNLIEZVTkNUSU9OXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdHJhY2tPcmRlcihcbiAgb3JkZXJOdW1iZXI6IHN0cmluZyxcbiAgZW1haWw6IHN0cmluZ1xuKTogUHJvbWlzZTx7XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG4gIGVycm9yPzogXCJJbnZhbGlkT3JkZXJOdW1iZXJcIiB8IFwiRW1haWxNaXNtYXRjaFwiO1xuICBvcmRlcj86IE9yZGVyO1xufT4ge1xuICBjb25zdCBjbGVhbk9yZGVyTnVtYmVyID0gb3JkZXJOdW1iZXIucmVwbGFjZSgvIy9nLCBcIlwiKTtcbiAgY29uc3Qgb3JkZXIgPSBhd2FpdCBnZXRPcmRlclF1ZXJ5KGNsZWFuT3JkZXJOdW1iZXIpO1xuICAvLyBPcmRlciBudW1iZXIgaXMgaW52YWxpZCBpZiBubyBvcmRlciBpcyBmb3VuZFxuICBpZiAoIW9yZGVyKSB7XG4gICAgcmV0dXJuIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBcIkludmFsaWRPcmRlck51bWJlclwiIH07XG4gIH1cblxuICAvLyBPcmRlciBleGlzdHMgYnV0IGVtYWlsIGRvZXMgbm90IG1hdGNoXG4gIGlmIChcbiAgICAhb3JkZXIuY29udGFjdF9lbWFpbCB8fFxuICAgIG9yZGVyLmNvbnRhY3RfZW1haWwudG9Mb3dlckNhc2UoKSAhPT0gZW1haWwudG9Mb3dlckNhc2UoKVxuICApIHtcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiRW1haWxNaXNtYXRjaFwiIH07XG4gIH1cblxuICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBvcmRlciB9O1xufVxuXG4vLyBDaGFuZ2UgZGVsaXZlcnkgMVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGV4dHJhY3RDb21wbGV0ZU9yZGVyKFxuICBvcmRlck51bWJlcjogc3RyaW5nLFxuICBlbWFpbDogc3RyaW5nXG4pOiBQcm9taXNlPHtcbiAgc3VjY2VzczogYm9vbGVhbjtcbiAgZXJyb3I/OiBcIkludmFsaWRPcmRlck51bWJlclwiIHwgXCJFbWFpbE1pc21hdGNoXCI7XG4gIG9yZGVyPzogT3JkZXI7XG59PiB7XG4gIGNvbnN0IGNsZWFuT3JkZXJOdW1iZXIgPSBvcmRlck51bWJlci5yZXBsYWNlKC8jL2csIFwiXCIpO1xuICBjb25zdCBvcmRlciA9IGF3YWl0IGdldE9yZGVyUXVlcnkoY2xlYW5PcmRlck51bWJlcik7XG4gIC8vIE9yZGVyIG51bWJlciBpcyBpbnZhbGlkIGlmIG5vIG9yZGVyIGlzIGZvdW5kXG4gIGlmICghb3JkZXIpIHtcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IFwiSW52YWxpZE9yZGVyTnVtYmVyXCIgfTtcbiAgfVxuXG4gIC8vIE9yZGVyIGV4aXN0cyBidXQgZW1haWwgZG9lcyBub3QgbWF0Y2hcbiAgaWYgKFxuICAgICFvcmRlci5jb250YWN0X2VtYWlsIHx8XG4gICAgb3JkZXIuY29udGFjdF9lbWFpbC50b0xvd2VyQ2FzZSgpICE9PSBlbWFpbC50b0xvd2VyQ2FzZSgpXG4gICkge1xuICAgIHJldHVybiB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogXCJFbWFpbE1pc21hdGNoXCIgfTtcbiAgfVxuXG4gIC8vIEJvdGggb3JkZXIgbnVtYmVyIGFuZCBlbWFpbCBtYXRjaFxuICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBvcmRlcjogb3JkZXIgfTtcbn1cblxuLy8gVXBkYXRlIHNoaXBwaW5nIGFkZHJlc3NcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVTaGlwcGluZ0FkZHJlc3MoXG4gIG9yZGVySWQ6IHN0cmluZyxcbiAgbmV3X2RlbGl2ZXJ5X2luZm86IHN0cmluZyxcbiAgYWRkcmVzc0RhdGE6IHtcbiAgICBmaXJzdF9uYW1lOiBzdHJpbmc7XG4gICAgbGFzdF9uYW1lOiBzdHJpbmc7XG4gICAgcGhvbmU6IHN0cmluZztcbiAgfVxuKTogUHJvbWlzZTx7XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG4gIGVycm9yPzogc3RyaW5nO1xuICBvcmRlcklkPzogc3RyaW5nO1xufT4ge1xuICBjb25zb2xlLmxvZyhcIlVwZGF0aW5nIHNoaXBwaW5nIGFkZHJlc3NcIik7XG5cbiAgLy8gRXh0cmFjdCBhZGRyZXNzIGNvbXBvbmVudHMgZnJvbSBHb29nbGUgUGxhY2VzIEFQSVxuICBjb25zdCBhZGRyZXNzQ29tcG9uZW50cyA9IHtcbiAgICBhZGRyZXNzMTogXCJcIixcbiAgICBhZGRyZXNzMjogXCJcIixcbiAgICBjaXR5OiBcIlwiLFxuICAgIHppcDogXCJcIixcbiAgICBwcm92aW5jZUNvZGU6IFwiXCIsXG4gIH07XG5cbiAgdHJ5IHtcbiAgICAvLyBVc2UgR1BULTQgdG8gcGFyc2UgdGhlIGFkZHJlc3MgY29tcG9uZW50c1xuICAgIGNvbnN0IGdwdFJlc3BvbnNlID0gYXdhaXQgZmV0Y2goXG4gICAgICBcImh0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEvY2hhdC9jb21wbGV0aW9uc1wiLFxuICAgICAge1xuICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Byb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZfWAsXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBtb2RlbDogXCJncHQtNG8tbWluaVwiLFxuICAgICAgICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIHJvbGU6IFwic3lzdGVtXCIsXG4gICAgICAgICAgICAgIGNvbnRlbnQ6IGBFeHRyYWN0IGFkZHJlc3MgY29tcG9uZW50cyBmcm9tIGFkZHJlc3NlcyBpbnRvIEpTT04gZm9ybWF0IHdpdGggdGhlc2Uga2V5czogYWRkcmVzczEsIGFkZHJlc3MyLCBjaXR5LCB6aXAsIHByb3ZpbmNlXG5cbiAgICAgICAgICAgICAgICAgIEV4YW1wbGUgaW5wdXQ6IFwiQ2FsbGUgR3JhbiBWaWEgMzIsIDRCLCBNYWRyaWQsIFNwYWluIDI4MDEzXCJcbiAgICAgICAgICAgICAgICAgIEV4YW1wbGUgb3V0cHV0OiB7XG4gICAgICAgICAgICAgICAgICAgIFwiYWRkcmVzczFcIjogXCJDYWxsZSBHcmFuIFZpYSAzMlwiLFxuICAgICAgICAgICAgICAgICAgICBcImFkZHJlc3MyXCI6IFwiNEJcIiwgXG4gICAgICAgICAgICAgICAgICAgIFwiY2l0eVwiOiBcIk1hZHJpZFwiLFxuICAgICAgICAgICAgICAgICAgICBcInppcFwiOiBcIjI4MDEzXCIsXG4gICAgICAgICAgICAgICAgICAgIFwicHJvdmluY2VcIjogXCJNYWRyaWRcIlxuICAgICAgICAgICAgICAgICAgfWAsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICByb2xlOiBcInVzZXJcIixcbiAgICAgICAgICAgICAgY29udGVudDogbmV3X2RlbGl2ZXJ5X2luZm8sXG4gICAgICAgICAgICB9LFxuICAgICAgICAgIF0sXG4gICAgICAgIH0pLFxuICAgICAgfVxuICAgICk7XG5cbiAgICBpZiAoIWdwdFJlc3BvbnNlLm9rKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gcGFyc2UgYWRkcmVzcyB3aXRoIEdQVFwiKTtcbiAgICB9XG5cbiAgICBjb25zdCBncHREYXRhID0gYXdhaXQgZ3B0UmVzcG9uc2UuanNvbigpO1xuICAgIGNvbnN0IHBhcnNlZEFkZHJlc3MgPSBKU09OLnBhcnNlKGdwdERhdGEuY2hvaWNlc1swXS5tZXNzYWdlLmNvbnRlbnQpO1xuICAgIGNvbnNvbGUubG9nKHBhcnNlZEFkZHJlc3MpO1xuXG4gICAgLy8gTWFwIHByb3ZpbmNlIG5hbWVzIHRvIGF1dG9ub21vdXMgY29tbXVuaXR5IGNvZGVzXG4gICAgY29uc3QgcHJvdmluY2VDb2RlTWFwOiB7IFtrZXk6IHN0cmluZ106IHN0cmluZyB9ID0ge1xuICAgICAgXCJBIENvcnXDsWFcIjogXCJDXCIsXG4gICAgICBcIkxhIENvcnXDsWFcIjogXCJDXCIsXG4gICAgICDDgWxhdmE6IFwiVklcIixcbiAgICAgIEFyYWJhOiBcIlZJXCIsXG4gICAgICBBbGJhY2V0ZTogXCJBQlwiLFxuICAgICAgQWxpY2FudGU6IFwiQVwiLFxuICAgICAgQWxhY2FudDogXCJBXCIsXG4gICAgICBBbG1lcsOtYTogXCJBTFwiLFxuICAgICAgQXN0dXJpYXM6IFwiT1wiLFxuICAgICAgw4F2aWxhOiBcIkFWXCIsXG4gICAgICBCYWRham96OiBcIkJBXCIsXG4gICAgICBcIklsbGVzIEJhbGVhcnNcIjogXCJQTVwiLFxuICAgICAgXCJJc2xhcyBCYWxlYXJlc1wiOiBcIlBNXCIsXG4gICAgICBCYWxlYXJzOiBcIlBNXCIsXG4gICAgICBCYXJjZWxvbmE6IFwiQlwiLFxuICAgICAgQnVyZ29zOiBcIkJVXCIsXG4gICAgICBDw6FjZXJlczogXCJDQ1wiLFxuICAgICAgQ8OhZGl6OiBcIkNBXCIsXG4gICAgICBDYW50YWJyaWE6IFwiU1wiLFxuICAgICAgQ2FzdGVsbMOzbjogXCJDU1wiLFxuICAgICAgQ2FzdGVsbMOzOiBcIkNTXCIsXG4gICAgICBDZXV0YTogXCJDRVwiLFxuICAgICAgXCJDaXVkYWQgUmVhbFwiOiBcIkNSXCIsXG4gICAgICBDw7NyZG9iYTogXCJDT1wiLFxuICAgICAgQ3VlbmNhOiBcIkNVXCIsXG4gICAgICBHaXB1emtvYTogXCJTU1wiLFxuICAgICAgR3VpcMO6emNvYTogXCJTU1wiLFxuICAgICAgR2lyb25hOiBcIkdJXCIsXG4gICAgICBHZXJvbmE6IFwiR0lcIixcbiAgICAgIEdyYW5hZGE6IFwiR1JcIixcbiAgICAgIEd1YWRhbGFqYXJhOiBcIkdVXCIsXG4gICAgICBIdWVsdmE6IFwiSFwiLFxuICAgICAgSHVlc2NhOiBcIkhVXCIsXG4gICAgICBKYcOpbjogXCJKXCIsXG4gICAgICBcIkxhIFJpb2phXCI6IFwiTE9cIixcbiAgICAgIFwiTGFzIFBhbG1hc1wiOiBcIkdDXCIsXG4gICAgICBMZcOzbjogXCJMRVwiLFxuICAgICAgTGxlaWRhOiBcIkxcIixcbiAgICAgIEzDqXJpZGE6IFwiTFwiLFxuICAgICAgTHVnbzogXCJMVVwiLFxuICAgICAgTWFkcmlkOiBcIk1cIixcbiAgICAgIE3DoWxhZ2E6IFwiTUFcIixcbiAgICAgIE1lbGlsbGE6IFwiTUxcIixcbiAgICAgIE11cmNpYTogXCJNVVwiLFxuICAgICAgTmF2YXJyYTogXCJOQVwiLFxuICAgICAgTmFmYXJyb2E6IFwiTkFcIixcbiAgICAgIE91cmVuc2U6IFwiT1JcIixcbiAgICAgIE9yZW5zZTogXCJPUlwiLFxuICAgICAgUGFsZW5jaWE6IFwiUFwiLFxuICAgICAgUG9udGV2ZWRyYTogXCJQT1wiLFxuICAgICAgU2FsYW1hbmNhOiBcIlNBXCIsXG4gICAgICBcIlNhbnRhIENydXogZGUgVGVuZXJpZmVcIjogXCJURlwiLFxuICAgICAgU2Vnb3ZpYTogXCJTR1wiLFxuICAgICAgU2V2aWxsYTogXCJTRVwiLFxuICAgICAgU29yaWE6IFwiU09cIixcbiAgICAgIFRhcnJhZ29uYTogXCJUXCIsXG4gICAgICBUZXJ1ZWw6IFwiVEVcIixcbiAgICAgIFRvbGVkbzogXCJUT1wiLFxuICAgICAgVmFsZW5jaWE6IFwiVlwiLFxuICAgICAgVmFsw6huY2lhOiBcIlZcIixcbiAgICAgIFZhbGxhZG9saWQ6IFwiVkFcIixcbiAgICAgIEJpemthaWE6IFwiQklcIixcbiAgICAgIFZpemNheWE6IFwiQklcIixcbiAgICAgIFphbW9yYTogXCJaQVwiLFxuICAgICAgWmFyYWdvemE6IFwiWlwiLFxuICAgIH07XG5cbiAgICAvLyBVcGRhdGUgYWRkcmVzcyBjb21wb25lbnRzIHdpdGggR1BUIHBhcnNlZCB2YWx1ZXNcbiAgICBhZGRyZXNzQ29tcG9uZW50cy5hZGRyZXNzMSA9IHBhcnNlZEFkZHJlc3MuYWRkcmVzczEgfHwgXCJcIjtcbiAgICBhZGRyZXNzQ29tcG9uZW50cy5hZGRyZXNzMiA9IHBhcnNlZEFkZHJlc3MuYWRkcmVzczIgfHwgXCJcIjtcbiAgICBhZGRyZXNzQ29tcG9uZW50cy5jaXR5ID0gcGFyc2VkQWRkcmVzcy5jaXR5IHx8IFwiXCI7XG4gICAgYWRkcmVzc0NvbXBvbmVudHMuemlwID0gcGFyc2VkQWRkcmVzcy56aXAgfHwgXCJcIjtcbiAgICBhZGRyZXNzQ29tcG9uZW50cy5wcm92aW5jZUNvZGUgPVxuICAgICAgcHJvdmluY2VDb2RlTWFwW3BhcnNlZEFkZHJlc3MucHJvdmluY2VdIHx8IFwiXCI7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIHZhbGlkYXRpbmcgYWRkcmVzczpcIiwgZXJyb3IpO1xuICAgIHJldHVybiB7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBcIkZhaWxlZCB0byB2YWxpZGF0ZSBhZGRyZXNzXCIsXG4gICAgfTtcbiAgfVxuICBjb25zb2xlLmxvZyhhZGRyZXNzQ29tcG9uZW50cyk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBxdWVyeSA9IGBtdXRhdGlvbiB1cGRhdGVPcmRlck1ldGFmaWVsZHMoJGlucHV0OiBPcmRlcklucHV0ISkge1xuICAgICAgb3JkZXJVcGRhdGUoaW5wdXQ6ICRpbnB1dCkge1xuICAgICAgICBvcmRlciB7XG4gICAgICAgICAgaWRcbiAgICAgICAgICBzaGlwcGluZ0FkZHJlc3Mge1xuICAgICAgICAgICAgYWRkcmVzczFcbiAgICAgICAgICAgIGFkZHJlc3MyXG4gICAgICAgICAgICBjaXR5XG4gICAgICAgICAgICBjb3VudHJ5Q29kZVxuICAgICAgICAgICAgZmlyc3ROYW1lXG4gICAgICAgICAgICBsYXN0TmFtZVxuICAgICAgICAgICAgcGhvbmVcbiAgICAgICAgICAgIHppcFxuICAgICAgICAgICAgcHJvdmluY2VDb2RlXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHVzZXJFcnJvcnMge1xuICAgICAgICAgIG1lc3NhZ2VcbiAgICAgICAgICBmaWVsZFxuICAgICAgICB9XG4gICAgICB9XG4gICAgfWA7XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKFxuICAgICAgYCR7cHJvY2Vzcy5lbnYuU0hPUF9VUkx9L2FkbWluL2FwaS8ke3Byb2Nlc3MuZW52LkFQSV9WRVJTSU9OfS9ncmFwaHFsLmpzb25gLFxuICAgICAge1xuICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgXCJYLVNob3BpZnktQWNjZXNzLVRva2VuXCI6IHByb2Nlc3MuZW52LlNIT1BJRllfQUNDRVNTX1RPS0VOIGFzIHN0cmluZyxcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIHF1ZXJ5LFxuICAgICAgICAgIHZhcmlhYmxlczoge1xuICAgICAgICAgICAgaW5wdXQ6IHtcbiAgICAgICAgICAgICAgaWQ6IG9yZGVySWQsXG4gICAgICAgICAgICAgIHNoaXBwaW5nQWRkcmVzczoge1xuICAgICAgICAgICAgICAgIC4uLmFkZHJlc3NDb21wb25lbnRzLFxuICAgICAgICAgICAgICAgIGNvdW50cnlDb2RlOiBcIkVTXCIsXG4gICAgICAgICAgICAgICAgZmlyc3ROYW1lOiBhZGRyZXNzRGF0YS5maXJzdF9uYW1lLFxuICAgICAgICAgICAgICAgIGxhc3ROYW1lOiBhZGRyZXNzRGF0YS5sYXN0X25hbWUsXG4gICAgICAgICAgICAgICAgcGhvbmU6IGFkZHJlc3NEYXRhLnBob25lLFxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9LFxuICAgICAgICB9KSxcbiAgICAgIH1cbiAgICApO1xuXG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICBjb25zb2xlLmxvZyhcIkRhdGFcIik7XG4gICAgY29uc29sZS5sb2coZGF0YSk7XG5cbiAgICBpZiAoIWRhdGEuZGF0YT8ub3JkZXJVcGRhdGUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogZGF0YS5lcnJvcnM/LlswXT8ubWVzc2FnZSB8fCBcIkZhaWxlZCB0byB1cGRhdGUgb3JkZXJcIixcbiAgICAgIH07XG4gICAgfVxuXG4gICAgaWYgKGRhdGEuZGF0YS5vcmRlclVwZGF0ZS51c2VyRXJyb3JzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogZGF0YS5kYXRhLm9yZGVyVXBkYXRlLnVzZXJFcnJvcnNbMF0ubWVzc2FnZSxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBvcmRlcklkOiBkYXRhLmRhdGEub3JkZXJVcGRhdGUub3JkZXIuaWQsXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgb3JkZXI6XCIsIGVycm9yKTtcbiAgICByZXR1cm4ge1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogXCJGYWlsZWQgdG8gdXBkYXRlIG9yZGVyXCIsXG4gICAgfTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZXh0cmFjdFByb2R1Y3QocHJvZHVjdE5hbWU6IHN0cmluZyk6IFByb21pc2U8e1xuICBzdWNjZXNzOiBib29sZWFuO1xuICBwcm9kdWN0PzogU2hvcGlmeURhdGFQcm9kdWN0IHwgbnVsbDtcbn0+IHtcbiAgY29uc3QgcHJvZHVjdFNob3BpZnkgPSBhd2FpdCBnZXRQcm9kdWN0UXVlcnkocHJvZHVjdE5hbWUpO1xuICBjb25zb2xlLmxvZyhcIlByb2R1Y3QgU2hvcGlmeVwiKTtcbiAgY29uc29sZS5sb2cocHJvZHVjdFNob3BpZnkpO1xuXG4gIGlmICghcHJvZHVjdFNob3BpZnkpIHtcbiAgICByZXR1cm4geyBzdWNjZXNzOiBmYWxzZSwgcHJvZHVjdDogbnVsbCB9O1xuICB9XG5cbiAgLy8gQm90aCBvcmRlciBudW1iZXIgYW5kIGVtYWlsIG1hdGNoXG4gIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIHByb2R1Y3Q6IHByb2R1Y3RTaG9waWZ5IH07XG59XG4iXSwibmFtZXMiOlsiY3JlYXRlU2Vzc2lvbiIsImdldE9yZGVyUXVlcnkiLCJvcmRlck51bWJlciIsInNlc3Npb24iLCJ1cmwiLCJwcm9jZXNzIiwiZW52IiwiU0hPUF9VUkwiLCJBUElfVkVSU0lPTiIsInJlc3BvbnNlIiwiZmV0Y2giLCJvayIsIkVycm9yIiwic3RhdHVzIiwiZGF0YSIsImpzb24iLCJvcmRlcnMiLCJlcnJvciIsImNvbnNvbGUiLCJnZXRQcm9kdWN0UXVlcnkiLCJwcm9kdWN0TmFtZSIsImVuY29kZVVSSUNvbXBvbmVudCIsInByb2R1Y3RzIiwidHJhY2tPcmRlciIsImVtYWlsIiwiY2xlYW5PcmRlck51bWJlciIsInJlcGxhY2UiLCJvcmRlciIsInN1Y2Nlc3MiLCJjb250YWN0X2VtYWlsIiwidG9Mb3dlckNhc2UiLCJleHRyYWN0Q29tcGxldGVPcmRlciIsInVwZGF0ZVNoaXBwaW5nQWRkcmVzcyIsIm9yZGVySWQiLCJuZXdfZGVsaXZlcnlfaW5mbyIsImFkZHJlc3NEYXRhIiwibG9nIiwiYWRkcmVzc0NvbXBvbmVudHMiLCJhZGRyZXNzMSIsImFkZHJlc3MyIiwiY2l0eSIsInppcCIsInByb3ZpbmNlQ29kZSIsImdwdFJlc3BvbnNlIiwibWV0aG9kIiwiaGVhZGVycyIsIkF1dGhvcml6YXRpb24iLCJPUEVOQUlfQVBJX0tFWSIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwibW9kZWwiLCJtZXNzYWdlcyIsInJvbGUiLCJjb250ZW50IiwiZ3B0RGF0YSIsInBhcnNlZEFkZHJlc3MiLCJwYXJzZSIsImNob2ljZXMiLCJtZXNzYWdlIiwicHJvdmluY2VDb2RlTWFwIiwiw4FsYXZhIiwiQXJhYmEiLCJBbGJhY2V0ZSIsIkFsaWNhbnRlIiwiQWxhY2FudCIsIkFsbWVyw61hIiwiQXN0dXJpYXMiLCLDgXZpbGEiLCJCYWRham96IiwiQmFsZWFycyIsIkJhcmNlbG9uYSIsIkJ1cmdvcyIsIkPDoWNlcmVzIiwiQ8OhZGl6IiwiQ2FudGFicmlhIiwiQ2FzdGVsbMOzbiIsIkNhc3RlbGzDsyIsIkNldXRhIiwiQ8OzcmRvYmEiLCJDdWVuY2EiLCJHaXB1emtvYSIsIkd1aXDDunpjb2EiLCJHaXJvbmEiLCJHZXJvbmEiLCJHcmFuYWRhIiwiR3VhZGFsYWphcmEiLCJIdWVsdmEiLCJIdWVzY2EiLCJKYcOpbiIsIkxlw7NuIiwiTGxlaWRhIiwiTMOpcmlkYSIsIkx1Z28iLCJNYWRyaWQiLCJNw6FsYWdhIiwiTWVsaWxsYSIsIk11cmNpYSIsIk5hdmFycmEiLCJOYWZhcnJvYSIsIk91cmVuc2UiLCJPcmVuc2UiLCJQYWxlbmNpYSIsIlBvbnRldmVkcmEiLCJTYWxhbWFuY2EiLCJTZWdvdmlhIiwiU2V2aWxsYSIsIlNvcmlhIiwiVGFycmFnb25hIiwiVGVydWVsIiwiVG9sZWRvIiwiVmFsZW5jaWEiLCJWYWzDqG5jaWEiLCJWYWxsYWRvbGlkIiwiQml6a2FpYSIsIlZpemNheWEiLCJaYW1vcmEiLCJaYXJhZ296YSIsInByb3ZpbmNlIiwicXVlcnkiLCJTSE9QSUZZX0FDQ0VTU19UT0tFTiIsInZhcmlhYmxlcyIsImlucHV0IiwiaWQiLCJzaGlwcGluZ0FkZHJlc3MiLCJjb3VudHJ5Q29kZSIsImZpcnN0TmFtZSIsImZpcnN0X25hbWUiLCJsYXN0TmFtZSIsImxhc3RfbmFtZSIsInBob25lIiwib3JkZXJVcGRhdGUiLCJlcnJvcnMiLCJ1c2VyRXJyb3JzIiwibGVuZ3RoIiwiZXh0cmFjdFByb2R1Y3QiLCJwcm9kdWN0U2hvcGlmeSIsInByb2R1Y3QiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/queries/order/index.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/axios","vendor-chunks/asynckit","vendor-chunks/math-intrinsics","vendor-chunks/es-errors","vendor-chunks/call-bind-apply-helpers","vendor-chunks/debug","vendor-chunks/get-proto","vendor-chunks/mime-db","vendor-chunks/has-symbols","vendor-chunks/gopd","vendor-chunks/function-bind","vendor-chunks/form-data","vendor-chunks/follow-redirects","vendor-chunks/supports-color","vendor-chunks/proxy-from-env","vendor-chunks/ms","vendor-chunks/mime-types","vendor-chunks/hasown","vendor-chunks/has-tostringtag","vendor-chunks/has-flag","vendor-chunks/get-intrinsic","vendor-chunks/es-set-tostringtag","vendor-chunks/es-object-atoms","vendor-chunks/es-define-property","vendor-chunks/dunder-proto","vendor-chunks/delayed-stream","vendor-chunks/combined-stream"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Froute&page=%2Fapi%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Froute.ts&appDir=%2FUsers%2Fsantiagogerickeparga%2FDesktop%2FAI%2Fmy-shopify-chatbot%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fsantiagogerickeparga%2FDesktop%2FAI%2Fmy-shopify-chatbot&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();